<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307027 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="2831"/>

<div>
<span><div style="-evernote-webclip:true"><br/><div style="font-size: 16px; display: inline-block;"><div><div style="font-family:&quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif;color:rgb(51, 51, 51);background:rgb(255, 255, 255) none repeat scroll 0% 0%;line-height:1.8;font-size:14px;"><div><div><div><div><div><div><div>
		<h1 style="padding:0px;color:rgb(0, 0, 0);margin:20px 0px 10px;font-weight:bold;border-bottom:1px solid rgb(221, 221, 221);font-size:14px;">
			<a href="https://www.cnblogs.com/jython/p/5425038.html" style="margin:0px;padding:0px;text-decoration:none;color:rgb(51, 51, 51);">使用awstats分析nginx日志</a>
		</h1>
		<div style="margin:0px;padding:0px;clear:both;"></div>
		<div style="margin:0px;padding:0px;">
			<div style="margin:0px;padding:0px;margin-bottom:20px;"><h2 style="padding:0px;color:rgb(0, 0, 0);font-size:21px;font-weight:bold;line-height:1.5;margin:10px 0px;">1.awstats介绍</h2>
<blockquote style="margin:0px;background:rgba(0, 0, 0, 0) none repeat scroll 0% 0%;border:2px solid rgb(239, 239, 239);padding:5px 10px;margin-top:10px;margin-bottom:10px;">
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;">本文主要是记录centos6.5下安装配置awstats，并统计nginx访问日志</p>
</blockquote>
<h4 style="padding:0px;color:rgb(0, 0, 0);font-size:14px;font-weight:bold;margin:10px 0px;">1.1 awstats介绍</h4>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;">awstats是一款日志统计工具，它使用Perl语言编写，可统计的日志类型包括appache，nginx，ftp，mail等，awstats对nginx日志统计非常详细，如统计项</p>
<ul style="margin:0px;padding:0px;margin-left:30px;padding-left:0px;">
<li style="margin:0px;padding:0px;list-style:outside none none;list-style-type:disc;">按参观时间:  按月历史统计   按日期统计   按星期   每小时浏览次数 </li>
<li style="margin:0px;padding:0px;list-style:outside none none;list-style-type:disc;">按参观者:  国家或地区   城市   IP   最近参观日期   无法反解译的IP地址   搜索引擎网站的机器人</li>
<li style="margin:0px;padding:0px;list-style:outside none none;list-style-type:disc;">浏览器统计:  每次参观所花时间   文件类别   下载  存取次数  入站处   出站处   操作系统版本  浏览器版本</li>
<li style="margin:0px;padding:0px;list-style:outside none none;list-style-type:disc;">反向链接:  来源网址   由那些搜索引擎转介</li>
<li style="margin:0px;padding:0px;list-style:outside none none;list-style-type:disc;">HTTP:  错误码   错误次数 (400)   错误次数 (403)   错误次数 (404) </li>
<li style="margin:0px;padding:0px;list-style:outside none none;list-style-type:disc;">搜索:  用以搜索的短语 用以搜索的关键词</li>
</ul>
<h4 style="padding:0px;color:rgb(0, 0, 0);font-size:14px;font-weight:bold;margin:10px 0px;"> </h4>
<h4 style="padding:0px;color:rgb(0, 0, 0);font-size:14px;font-weight:bold;margin:10px 0px;">1.2 awstats目录</h4>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;">1.2.1 awstats有二进制rpm包，也有源码包，文中使用源码包安装，安装目录是/usr/local/awstats, wwwroot是web视图需要的资源文件，tools是一些统计脚本</p>
<div style="background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);padding:5px;overflow:auto;margin:5px 0px;color:rgb(0, 0, 0);font-family:Courier New;font-size:12px;">
<pre style="margin:0px;padding:0px;margin-top:0px;margin-bottom:0px;overflow-wrap:break-word;white-space:pre-wrap;font-family:Courier New;font-size:12px;">awstats/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">
├── docs
├── README.md
├── tools
└── wwwroot</span></pre>
</div>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;">1.2.2 awstats配置文件目录/etc/awstats/（默认目录）</p>
<div style="background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);padding:5px;overflow:auto;margin:5px 0px;color:rgb(0, 0, 0);font-family:Courier New;font-size:12px;">
<pre style="margin:0px;padding:0px;margin-top:0px;margin-bottom:0px;overflow-wrap:break-word;white-space:pre-wrap;font-family:Courier New;font-size:12px;"><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">awstats.www.test.com.conf    #站点www.test.com的配置文件
awstats.bbs.test.com.conf    #站点bbs.test.com配置文件</span></pre>
</div>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;">1.2.3 awstats数据文件存放目录/var/lib/awstats/<br style="margin:0px;padding:0px;"/>awstats从日志统计的数据文件保存在这个目录，这些数据文件可用于生成最终的html页面</p>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:12px;"><em style="margin:0px;padding:0px;">#以上目录都可以在配置文件中指定</em></span></p>
<h4 style="padding:0px;color:rgb(0, 0, 0);font-size:14px;font-weight:bold;margin:10px 0px;"> </h4>
<h4 style="padding:0px;color:rgb(0, 0, 0);font-size:14px;font-weight:bold;margin:10px 0px;">1.3 awstats脚本用法</h4>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;">1.3.1 awstats_configure.pl 主要用它生成各个站点配置文件</p>
<div style="background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);padding:5px;overflow:auto;margin:5px 0px;color:rgb(0, 0, 0);font-family:Courier New;font-size:12px;">
<pre style="margin:0px;padding:0px;margin-top:0px;margin-bottom:0px;overflow-wrap:break-word;white-space:pre-wrap;font-family:Courier New;font-size:12px;">/usr/local/awstats/tools/awstats_configure.pl --<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">help
...
 </span>- Create one AWStats config <span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">file</span> (<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">if</span> asked) </pre>
</div>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;">1.3.2 awstats.pl用来生成或更新awstats数据文件</p>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;">它会分析nginx的访问日志，把分析结果更新到/var/lib/awstats数据文件中去，因此分析完的日志即使删除，只要/var/lib/awstats中的数据文件不丢失，就不会影响统计结果</p>
<div style="background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);padding:5px;overflow:auto;margin:5px 0px;color:rgb(0, 0, 0);font-family:Courier New;font-size:12px;">
<pre style="margin:0px;padding:0px;margin-top:0px;margin-bottom:0px;overflow-wrap:break-word;white-space:pre-wrap;font-family:Courier New;font-size:12px;">/usr/bin/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">perl</span> /usr/local/awstats/wwwroot/cgi-bin/awstats.pl -update -config=www.test.com -configdir=/etc/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">awstats
</span>-<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">update: 更新统计数据文件
</span>-<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">config: 更新www.test.com这个站点
</span>-configdir: 配置文件目录，/etc/awstats是默认位置，awstats会读取此目录下由<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">-config</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span>参数指定的站点的配置文件(awstats.www.test.com.conf)</pre>
</div>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;">1.3.3 awstats_updateall.pl是awstats.pl的封装，更新所有站点统计数据</p>
<div style="background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);padding:5px;overflow:auto;margin:5px 0px;color:rgb(0, 0, 0);font-family:Courier New;font-size:12px;"><div style="margin:0px;padding:0px;margin-top:5px;background-color:rgb(245, 245, 245);"><span style="margin:0px;padding:0px;padding-right:5px;font-family:Courier New;font-size:12px;line-height:1.5;"><a href="#" style="margin:0px;padding:0px;text-decoration:none;color:rgb(0, 0, 0);border-bottom:1px dotted rgb(51, 51, 51);background-color:rgb(245, 245, 245);border:medium none;" title="复制代码"><img src="awstats_files/copycode.gif" type="image/gif" data-filename="copycode.gif" alt="复制代码" height="20" style="margin:0px;padding:0px;height:auto;max-width:300px;border:medium none;background-color:rgb(245, 245, 245);" width="20"/></a></span></div>
<pre style="margin:0px;padding:0px;margin-top:0px;margin-bottom:0px;overflow-wrap:break-word;white-space:pre-wrap;font-family:Courier New;font-size:12px;">/usr/local/awstats/tools/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">awstats_updateall.pl 
...
Where options are:
  </span>-awstatsprog=<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">pathtoawstatspl
  </span>-configdir=<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">directorytoscan
  </span>-excludeconf=<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">conftoexclude[,conftoexclude2,...] (Note: awstats.model.conf is always excluded)

</span>/usr/local/awstats/tools/awstats_updateall.pl now -awstatsprog=/usr/local/awstats/wwwroot/cgi-bin/awstats.pl -excludeconf=<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">www.test.com
</span>-<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">awstatsprog: 更新脚本路径
</span>-<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">excludeconf: 可选项，更新所有站点数据，但是排除www.test.com这个站点

#此脚本最终调用的还是awstats.pl</span></pre>
<div style="margin:0px;padding:0px;margin-top:5px;background-color:rgb(245, 245, 245);"><span style="margin:0px;padding:0px;padding-right:5px;font-family:Courier New;font-size:12px;line-height:1.5;"><a href="#" style="margin:0px;padding:0px;text-decoration:none;color:rgb(0, 0, 0);border-bottom:1px dotted rgb(51, 51, 51);background-color:rgb(245, 245, 245);border:medium none;" title="复制代码"><img src="awstats_files/copycode [1].gif" type="image/gif" data-filename="copycode.gif" alt="复制代码" height="20" style="margin:0px;padding:0px;height:auto;max-width:300px;border:medium none;background-color:rgb(245, 245, 245);" width="20"/></a></span></div></div>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;">1.3.4 awstats_buildstaticpages.pl用于读取数据文件/var/lib/awstats/*并创建或更新html页面</p>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;">这个脚本默认只是根据/var/lib/awstats/下的数据文件更新html，如果要在html页面看到新日志的统计，要先使用awstats.pl更新数据文件，然后再更新html</p>
<div style="background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);padding:5px;overflow:auto;margin:5px 0px;color:rgb(0, 0, 0);font-family:Courier New;font-size:12px;"><div style="margin:0px;padding:0px;margin-top:5px;background-color:rgb(245, 245, 245);"><span style="margin:0px;padding:0px;padding-right:5px;font-family:Courier New;font-size:12px;line-height:1.5;"><a href="#" style="margin:0px;padding:0px;text-decoration:none;color:rgb(0, 0, 0);border-bottom:1px dotted rgb(51, 51, 51);background-color:rgb(245, 245, 245);border:medium none;" title="复制代码"><img src="awstats_files/copycode [2].gif" type="image/gif" data-filename="copycode.gif" alt="复制代码" height="20" style="margin:0px;padding:0px;height:auto;max-width:300px;border:medium none;background-color:rgb(245, 245, 245);" width="20"/></a></span></div>
<pre style="margin:0px;padding:0px;margin-top:0px;margin-bottom:0px;overflow-wrap:break-word;white-space:pre-wrap;font-family:Courier New;font-size:12px;">/usr/local/awstats/tools/awstats_buildstaticpages.pl --<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">help
</span>/usr/local/awstats/tools/awstats_buildstaticpages.pl -update -config=www.test.com -lang=cn -awstatsprog=/usr/local/awstats/wwwroot/cgi-bin/awstats.pl -<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">dir</span>=/home/awstats-logs/web/
-<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">update:更新html页面之前，先更新数据文件(调用awstats.pl脚本)
</span>-<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">lang: 输出语言为cn
</span>-<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">dir</span>: html页面存放目录</pre>
<div style="margin:0px;padding:0px;margin-top:5px;background-color:rgb(245, 245, 245);"><span style="margin:0px;padding:0px;padding-right:5px;font-family:Courier New;font-size:12px;line-height:1.5;"><a href="#" style="margin:0px;padding:0px;text-decoration:none;color:rgb(0, 0, 0);border-bottom:1px dotted rgb(51, 51, 51);background-color:rgb(245, 245, 245);border:medium none;" title="复制代码"><img src="awstats_files/copycode [3].gif" type="image/gif" data-filename="copycode.gif" alt="复制代码" height="20" style="margin:0px;padding:0px;height:auto;max-width:300px;border:medium none;background-color:rgb(245, 245, 245);" width="20"/></a></span></div></div>
<h4 style="padding:0px;color:rgb(0, 0, 0);font-size:14px;font-weight:bold;margin:10px 0px;"> </h4>
<h4 style="padding:0px;color:rgb(0, 0, 0);font-size:14px;font-weight:bold;margin:10px 0px;">1.4 awstats工作流程</h4>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;">awstats工作流程如下：</p>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:outside none none;list-style-type:decimal;">触发更新进程，并指定此次更新的站点</li>
<li style="margin:0px;padding:0px;list-style:outside none none;list-style-type:decimal;">awstats根据站点名读取/etc/awstats下相应的配置文件</li>
<li style="margin:0px;padding:0px;list-style:outside none none;list-style-type:decimal;">根据配置文件中指定的日志路径分析日志，并把数据文件存放在/var/lib/awstats目录</li>
<li style="margin:0px;padding:0px;list-style:outside none none;list-style-type:decimal;">随后执行构建html页面脚本，从数据文件构建html到指定目录中</li>
<li style="margin:0px;padding:0px;list-style:outside none none;list-style-type:decimal;">配置web服务器，通过web访问这些html页面，得到统计结果</li>
<li style="margin:0px;padding:0px;list-style:outside none none;list-style-type:decimal;">设置定时任务，自动触发更新进程，循环1，2，3，4，5步骤</li>
</ol>
<h4 style="padding:0px;color:rgb(0, 0, 0);font-size:14px;font-weight:bold;margin:10px 0px;"> </h4>
<h4 style="padding:0px;color:rgb(0, 0, 0);font-size:14px;font-weight:bold;margin:10px 0px;">1.5 awstats统计结果</h4>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;">awstats统计结果可以配置为静态html，也可以配置使用动态页面（动态页面支持网页端更新日志，指定查看某一个日期的统计结果，但需要cgi支持），两者的区别如下：</p>
<ul style="margin:0px;padding:0px;margin-left:30px;padding-left:0px;">
<li style="margin:0px;padding:0px;list-style:outside none none;list-style-type:disc;">静态页面中展示了具体统计结果，awstats提供有脚本用于更新统计结果，可以设置crontab实现定时更新新产生的日志</li>
<li style="margin:0px;padding:0px;list-style:outside none none;list-style-type:disc;">动态页面使用GET请求来获取统计结果，GET请求中带有查询参数，这些参数最终会传递给awstats.pl脚本，awstats本身并不提供CGI支持,需要自己配置CGI支持</li>
</ul>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="margin:0px;padding:0px;color:#ff0000;">上面是对awstats整体介绍，下面我们以站点www.test.com,bbs.test.com为例说明配置过程，需要建立两个配置文件，在两个配置文件中分别指定www,bbs的日志路径以及其它参数</span></p>
<h2 style="padding:0px;color:rgb(0, 0, 0);font-size:21px;font-weight:bold;line-height:1.5;margin:10px 0px;"> </h2>
<h2 style="padding:0px;color:rgb(0, 0, 0);font-size:21px;font-weight:bold;line-height:1.5;margin:10px 0px;">2.awstats配置</h2>
<h4 style="padding:0px;color:rgb(0, 0, 0);font-size:14px;font-weight:bold;margin:10px 0px;">2.1 安装</h4>
<div style="background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);padding:5px;overflow:auto;margin:5px 0px;color:rgb(0, 0, 0);font-family:Courier New;font-size:12px;">
<pre style="margin:0px;padding:0px;margin-top:0px;margin-bottom:0px;overflow-wrap:break-word;white-space:pre-wrap;font-family:Courier New;font-size:12px;">cd /<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">opt
</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">wget</span> http:<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#008000;">//</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#008000;">prdownloads.sourceforge.net/awstats/awstats-7.4.tar.gz</span>
<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">tar</span> xvf awstats-<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800080;">7.4</span>.<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">tar</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">.gz
</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">mv</span> awstats-<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800080;">7.4</span> /usr/local/awstats</pre>
</div>
<h4 style="padding:0px;color:rgb(0, 0, 0);font-size:14px;font-weight:bold;margin:10px 0px;"> </h4>
<h4 style="padding:0px;color:rgb(0, 0, 0);font-size:14px;font-weight:bold;margin:10px 0px;">2.2 生成www站点配置文件</h4>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;">由于www站点配置文件和bbs配置文件只是读取的日志不一样，其它参数设置可以保持一致，因此本文先建立www站点配置文件，并修改好必要参数，这样就可以以此配置文件为模板，建立其它站点配置文件</p>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;">配置文件默认存放于/etc/awstats下，生成配置文件步骤如下</p>
<div style="background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);padding:5px;overflow:auto;margin:5px 0px;color:rgb(0, 0, 0);font-family:Courier New;font-size:12px;"><div style="margin:0px;padding:0px;margin-top:5px;background-color:rgb(245, 245, 245);"><span style="margin:0px;padding:0px;padding-right:5px;font-family:Courier New;font-size:12px;line-height:1.5;"><a href="#" style="margin:0px;padding:0px;text-decoration:none;color:rgb(0, 0, 0);border-bottom:1px dotted rgb(51, 51, 51);background-color:rgb(245, 245, 245);border:medium none;" title="复制代码"><img src="awstats_files/copycode [4].gif" type="image/gif" data-filename="copycode.gif" alt="复制代码" height="20" style="margin:0px;padding:0px;height:auto;max-width:300px;border:medium none;background-color:rgb(245, 245, 245);" width="20"/></a></span></div>
<pre style="margin:0px;padding:0px;margin-top:0px;margin-bottom:0px;overflow-wrap:break-word;white-space:pre-wrap;font-family:Courier New;font-size:12px;">[root@lnmptest tools]# ./<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">awstats_configure.pl 
...
Example: </span>/etc/httpd/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">httpd.conf
Example: </span>/usr/local/apache2/conf/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">httpd.conf
Example: c:\Program files\apache group\apache\conf\httpd.conf
Config </span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">file</span> path (<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">'</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">none</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">'</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;"> to skip web server setup):
</span>&gt;<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;"> none  #我们这里配置的是nginx，所以输入none

Your web server config </span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">file</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">(s) could not be found.
You will need to setup your web server manually to declare AWStats
script as a CGI, </span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">if</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;"> you want to build reports dynamically.
See AWStats setup documentation (</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">file</span> docs/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">index.html)

</span>-----&gt; Update model config <span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">file</span> <span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">'</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">/usr/local/awstats/wwwroot/cgi-bin/awstats.model.conf</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">'</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">
  File awstats.model.conf updated.

</span>-----&gt; Need to create a new config <span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">file</span> ?<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">
Do you want me to build a new AWStats config</span>/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">profile
</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">file</span> (required <span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">if</span> first <span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">install</span>) [y/N] ?<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;"> y      #y表示新建一个配置文件

</span>-----&gt; Define config <span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">file</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;"> name to create
What is the name of your web site or profile analysis </span>?<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">
Example: www.mysite.com
Example: demo
Your web site, virtual server or profile name:
</span>&gt; www.test.com     #这个配置文件是统计www.test.com这个站点的，名字可以随便写，与在awstats.pl中<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">-config</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">参数指定的站点名保持一致就好

</span>-----&gt; Define config <span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">file</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;"> path
In </span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">which</span> directory <span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">do</span> you plan to store your config <span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">file</span>(s) ?<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">
Default: </span>/etc/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">awstats
Directory path to store config </span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">file</span>(s) (Enter <span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">for</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;"> default):
</span>&gt;<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">               #直接回车

</span>-----&gt; Create config <span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">file</span> <span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">'</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">/etc/awstats/awstats.www.testme.com.conf</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">'</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">
 Config </span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">file</span> /etc/awstats/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">awstats.www.testme.com.conf created.
...
</span>/usr/local/awstats/tools/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">awstats_updateall.pl now
Press ENTER to continue... 
...
Press ENTER to finish...</span></pre>
<div style="margin:0px;padding:0px;margin-top:5px;background-color:rgb(245, 245, 245);"><span style="margin:0px;padding:0px;padding-right:5px;font-family:Courier New;font-size:12px;line-height:1.5;"><a href="#" style="margin:0px;padding:0px;text-decoration:none;color:rgb(0, 0, 0);border-bottom:1px dotted rgb(51, 51, 51);background-color:rgb(245, 245, 245);border:medium none;" title="复制代码"><img src="awstats_files/copycode [5].gif" type="image/gif" data-filename="copycode.gif" alt="复制代码" height="20" style="margin:0px;padding:0px;height:auto;max-width:300px;border:medium none;background-color:rgb(245, 245, 245);" width="20"/></a></span></div></div>
<h4 style="padding:0px;color:rgb(0, 0, 0);font-size:14px;font-weight:bold;margin:10px 0px;"> </h4>
<h4 style="padding:0px;color:rgb(0, 0, 0);font-size:14px;font-weight:bold;margin:10px 0px;">2.3 修改www站点配置文件</h4>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;">2.3.1 LogFile参数</p>
<div style="background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);padding:5px;overflow:auto;margin:5px 0px;color:rgb(0, 0, 0);font-family:Courier New;font-size:12px;"><div style="margin:0px;padding:0px;margin-top:5px;background-color:rgb(245, 245, 245);"><span style="margin:0px;padding:0px;padding-right:5px;font-family:Courier New;font-size:12px;line-height:1.5;"><a href="#" style="margin:0px;padding:0px;text-decoration:none;color:rgb(0, 0, 0);border-bottom:1px dotted rgb(51, 51, 51);background-color:rgb(245, 245, 245);border:medium none;" title="复制代码"><img src="awstats_files/copycode [6].gif" type="image/gif" data-filename="copycode.gif" alt="复制代码" height="20" style="margin:0px;padding:0px;height:auto;max-width:300px;border:medium none;background-color:rgb(245, 245, 245);" width="20"/></a></span></div>
<pre style="margin:0px;padding:0px;margin-top:0px;margin-bottom:0px;overflow-wrap:break-word;white-space:pre-wrap;font-family:Courier New;font-size:12px;">#vim /etc/awstats/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">awstats.www.test.com.conf

#LogFile</span>=<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">/usr/local/awstats/tools/logresolvemerge.pl /home/logs/www/*.log |</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">
#LogFile</span>=<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">/home/logs/www/%YYYY-480%MM-480%DD-480.www.test.access.log</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">
#LogFile</span>=<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">/home/logs/www/www.test.com.access.log</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">

#如上,LogFile参数有多种写法，配置文件中已经解释很详细，主要如下
#</span>%YYYY%MM%DD: #此变量表示当前本地时间，比如今天是2015年11月8号，则此变量为<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">20151108</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">(不包括双引号，下同)
#</span>%YYYY-<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800080;">24</span>%MM-<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800080;">24</span>%DD-<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800080;">24</span>: #当前时间的24小时之前，即昨天此刻，<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">20151107</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">
#</span>%YYYY-<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800080;">240</span>%MM-<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800080;">240</span>%DD-<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800080;">240</span>: #240小时之前，即10天前此刻,<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">20151029</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">
#</span>%YYYY-<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800080;">240</span>%MM-<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800080;">2400</span>%DD-<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800080;">240</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">.www.test.access.log: #会匹配20151029.www.test.access.log 这条日志
#</span>%YYYY-<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800080;">240</span>%MM-<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800080;">2400</span>%DD-<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800080;">240</span>.*.log: #会匹配以<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">20151029</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span>开头，以<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">.log</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">结尾的所有日志
#</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">/usr/local/awstats/tools/logresolvemerge.pl /home/logs/www/*.log |</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span>: 使用logresolvemerge.pl合并统计/home/logs/www下所有以<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">.log</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span>结尾的文件，最后的管道符号<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">|</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span>不能少</pre>
<div style="margin:0px;padding:0px;margin-top:5px;background-color:rgb(245, 245, 245);"><span style="margin:0px;padding:0px;padding-right:5px;font-family:Courier New;font-size:12px;line-height:1.5;"><a href="#" style="margin:0px;padding:0px;text-decoration:none;color:rgb(0, 0, 0);border-bottom:1px dotted rgb(51, 51, 51);background-color:rgb(245, 245, 245);border:medium none;" title="复制代码"><img src="awstats_files/copycode [7].gif" type="image/gif" data-filename="copycode.gif" alt="复制代码" height="20" style="margin:0px;padding:0px;height:auto;max-width:300px;border:medium none;background-color:rgb(245, 245, 245);" width="20"/></a></span></div></div>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;">2.3.2  LogFormat参数</p>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;">不同的web日志具有不同格式，此参数定义awstats要读取的日志格式，默认情况下，LogFormat值为1</p>
<div style="background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);padding:5px;overflow:auto;margin:5px 0px;color:rgb(0, 0, 0);font-family:Courier New;font-size:12px;">
<pre style="margin:0px;padding:0px;margin-top:0px;margin-bottom:0px;overflow-wrap:break-word;white-space:pre-wrap;font-family:Courier New;font-size:12px;">LogFormat=<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800080;">1</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">
#关于具体情况，参考此配置文件中的注释</span></pre>
</div>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;">如果LogFormat值设为1，则awstats能够读取的日志格式为<a href="http://publib.boulder.ibm.com/tividd/td/ITWSA/ITWSA_info45/en_US/HTML/guide/c-logs.html#combined" style="margin:0px;padding:0px;text-decoration:none;color:rgb(0, 0, 0);border-bottom:1px dotted rgb(51, 51, 51);" target="_blank">NCSA Combined Log Format</a>, nginx默认的输出格式也符合NCSA Combined Log Format, 因此awstats能够读取nginx的输出日志，nginx输出日志格式如下：</p>
<div style="background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);padding:5px;overflow:auto;margin:5px 0px;color:rgb(0, 0, 0);font-family:Courier New;font-size:12px;">
<pre style="margin:0px;padding:0px;margin-top:0px;margin-bottom:0px;overflow-wrap:break-word;white-space:pre-wrap;font-family:Courier New;font-size:12px;">log_format  main  <span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">'</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">$remote_addr - $remote_user [$time_local] &quot;$request&quot; </span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">'</span>
                    <span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">'</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">$status $body_bytes_sent &quot;$http_referer&quot; </span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">'</span>
                    <span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">'</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;$http_user_agent&quot; $http_x_forwarded_for</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">'</span>;</pre>
</div>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"><span style="margin:0px;padding:0px;font-size:13px;"><em style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;color:#ff0000;">注意：nginx日志最后一个字段&quot;<span style="margin:0px;padding:0px;display:inline;font-style:normal;font-weight:normal;line-height:normal;font-size:100%;font-size-adjust:none;text-indent:0px;text-align:left;text-transform:none;letter-spacing:normal;word-spacing:normal;overflow-wrap:normal;white-space:nowrap;float:none;direction:ltr;max-width:none;max-height:none;min-width:0px;min-height:0px;border:0px none;position:relative;"><span style="transition:none 0s ease 0s;margin:0px;padding:0px;display:inline;position:static;border:0px none;vertical-align:0px;line-height:normal;text-decoration:none;"><span style="margin:0px;padding:1px 3px;display:inline-block;transition:none 0s ease 0s;position:static;vertical-align:0px;line-height:normal;text-decoration:none;border:1px solid;font-size:90%;text-align:left;color:black;">http_x_forwarded_for&quot;并不会被awstats所使用, awstats会使用第一个字段&quot;</span></span><span style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);transition:none 0s ease 0s;margin:0px;vertical-align:0px;line-height:normal;text-decoration:none;padding:1px 0px 0px;position:absolute;border:0px none;height:1px;width:1px;overflow:hidden;display:block;"><span style="margin:0px;padding:0px;transition:none 0s ease 0s;"><span style="margin:0px;padding:0px;transition:none 0s ease 0s;"><span style="margin:0px;padding:0px;transition:none 0s ease 0s;">http_x_forwarded_for&quot;并不会被awstats所使用, awstats会使用第一个字段&quot;</span></span></span></span></span>remote_addr&quot;作为终端用户IP进行统计，但是如果你的网站做的CDN, 或者使用代理访问, 那最后一个字段记录的IP才是真正终端用户的IP(此部分内容请参考nginx相关资料)，因此如果你的网站做过CDN，或者使用代理，那么就需要做下面的修改以使awstats统计到真正的用户IP，而非CDN节点或代理的IP</span></em></span></p>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;">第一种方法，我们可以自定义awstats读取日志的格式，需要修改LogFormat参数</p>
<div style="background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);padding:5px;overflow:auto;margin:5px 0px;color:rgb(0, 0, 0);font-family:Courier New;font-size:12px;">
<pre style="margin:0px;padding:0px;margin-top:0px;margin-bottom:0px;overflow-wrap:break-word;white-space:pre-wrap;font-family:Courier New;font-size:12px;">LogFormat = <span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">%otherquot - %host_r %time1 %methodurl %code %bytesd %refererquot %uaquot %host</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">
#这一行告诉awstats传入的nignx日志中每一个字段的意义，第一个参数</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">%otherquot</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span>告诉awstats不要读取此字段所代表的内容，即忽略<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">$remote_addr</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span>的内容，nginx日志的最后一个字段<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">http_x_forwarded_for</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span>才是awstats应该使用的<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">%host</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span></pre>
</div>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;">第二种方法不修改LogFormat参数，修改nginx日志记录格式，把&quot;<span style="margin:0px;padding:0px;display:inline;font-style:normal;font-weight:normal;line-height:normal;font-size:100%;font-size-adjust:none;text-indent:0px;text-align:left;text-transform:none;letter-spacing:normal;word-spacing:normal;overflow-wrap:normal;white-space:nowrap;float:none;direction:ltr;max-width:none;max-height:none;min-width:0px;min-height:0px;border:0px none;position:relative;"><span style="transition:none 0s ease 0s;margin:0px;padding:0px;display:inline;position:static;border:0px none;vertical-align:0px;line-height:normal;text-decoration:none;"><span style="margin:0px;padding:1px 3px;display:inline-block;transition:none 0s ease 0s;position:static;vertical-align:0px;line-height:normal;text-decoration:none;border:1px solid;font-size:90%;text-align:left;color:black;">http_x_forwarded_for&quot;字段调到首字段，&quot;</span></span><span style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);transition:none 0s ease 0s;margin:0px;vertical-align:0px;line-height:normal;text-decoration:none;padding:1px 0px 0px;position:absolute;border:0px none;height:1px;width:1px;overflow:hidden;display:block;"><span style="margin:0px;padding:0px;transition:none 0s ease 0s;"><span style="margin:0px;padding:0px;transition:none 0s ease 0s;"><span style="margin:0px;padding:0px;transition:none 0s ease 0s;">http_x_forwarded_for&quot;字段调到首字段，&quot;</span></span></span></span></span>remote_addr&quot;调到最后一字段，或者使用脚本把nginx日志中最后一个字段记录的用户真实IP和第一个字段对调</p>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;">2.3.3 其它参数</p>
<div style="background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);padding:5px;overflow:auto;margin:5px 0px;color:rgb(0, 0, 0);font-family:Courier New;font-size:12px;"><div style="margin:0px;padding:0px;margin-top:5px;background-color:rgb(245, 245, 245);"><span style="margin:0px;padding:0px;padding-right:5px;font-family:Courier New;font-size:12px;line-height:1.5;"><a href="#" style="margin:0px;padding:0px;text-decoration:none;color:rgb(0, 0, 0);border-bottom:1px dotted rgb(51, 51, 51);background-color:rgb(245, 245, 245);border:medium none;" title="复制代码"><img src="awstats_files/copycode [8].gif" type="image/gif" data-filename="copycode.gif" alt="复制代码" height="20" style="margin:0px;padding:0px;height:auto;max-width:300px;border:medium none;background-color:rgb(245, 245, 245);" width="20"/></a></span></div>
<pre style="margin:0px;padding:0px;margin-top:0px;margin-bottom:0px;overflow-wrap:break-word;white-space:pre-wrap;font-family:Courier New;font-size:12px;"><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">#日志类型，nginx日志使用W即可
# Enter the log </span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">file</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;"> type you want to analyze.
# Possible values:
#  W </span>- For a web log <span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">file</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">
#  S </span>- For a streaming log <span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">file</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">
#  M </span>- For a mail log <span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">file</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">
#  F </span>- For a <span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">ftp</span> log <span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">file</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">
# Example: W
# Default: W
#
LogType</span>=<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">W

#数据文件保存目录
DirData</span>=<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">/var/lib/awstats</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">

#网页端支持刷新数据（静态页面不需要此参数，只有使用动态页面才需要）
AllowToUpdateStatsFromBrowser</span>=<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800080;">1</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">

#开启地理位置支持（显示IP所在国家，城市统计）
LoadPlugin</span>=<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">geoip GEOIP_STANDARD  /usr/share/GeoIP/GeoIP.dat</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">
LoadPlugin</span>=<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">geoip_city_maxmind GEOIP_STANDARD /usr/share/GeoIP/GeoIPCity.dat</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">
#</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">yum</span> <span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">install</span> GeoIP GeoIP-data GeoIP-devel <span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">perl</span>-Geo-IP -<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">y   #先安装软件包

#解决中文乱码（去掉注释）
LoadPlugin</span>=<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">decodeutfkeys</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span></pre>
<div style="margin:0px;padding:0px;margin-top:5px;background-color:rgb(245, 245, 245);"><span style="margin:0px;padding:0px;padding-right:5px;font-family:Courier New;font-size:12px;line-height:1.5;"><a href="#" style="margin:0px;padding:0px;text-decoration:none;color:rgb(0, 0, 0);border-bottom:1px dotted rgb(51, 51, 51);background-color:rgb(245, 245, 245);border:medium none;" title="复制代码"><img src="awstats_files/copycode [9].gif" type="image/gif" data-filename="copycode.gif" alt="复制代码" height="20" style="margin:0px;padding:0px;height:auto;max-width:300px;border:medium none;background-color:rgb(245, 245, 245);" width="20"/></a></span></div></div>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;">2.3.4 生成其它站点配置文件</p>
<div style="background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);padding:5px;overflow:auto;margin:5px 0px;color:rgb(0, 0, 0);font-family:Courier New;font-size:12px;">
<pre style="margin:0px;padding:0px;margin-top:0px;margin-bottom:0px;overflow-wrap:break-word;white-space:pre-wrap;font-family:Courier New;font-size:12px;"><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">cp</span> /etc/awstats/awstats.www.test.com.conf /usr/local/awstats/wwwroot/cgi-bin/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">awstats.model.conf
#</span>/usr/local/awstats/wwwroot/cgi-bin/awstats.model.conf 此配置文件为awstats_configure.pl脚本生成配置文件时的模板</pre>
</div>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;">生成bbs站点配置文件</p>
<div style="background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);padding:5px;overflow:auto;margin:5px 0px;color:rgb(0, 0, 0);font-family:Courier New;font-size:12px;">
<pre style="margin:0px;padding:0px;margin-top:0px;margin-bottom:0px;overflow-wrap:break-word;white-space:pre-wrap;font-family:Courier New;font-size:12px;">cd /usr/local/awstats/tools/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">
.</span>/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">awstats_configure.pl
...
#参考生成www步骤</span></pre>
</div>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;">由于使用了www的模板，因此上面步骤生成的bbs配置文件将会与前面www配置文件一样，只需要修改LogFile参数即可</p>
<div style="background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);padding:5px;overflow:auto;margin:5px 0px;color:rgb(0, 0, 0);font-family:Courier New;font-size:12px;">
<pre style="margin:0px;padding:0px;margin-top:0px;margin-bottom:0px;overflow-wrap:break-word;white-space:pre-wrap;font-family:Courier New;font-size:12px;">#<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">cat</span> /etc/awstats/awstats.bbs.test.com.conf | <span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">grep</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;"> LogFile
LogFile</span>=<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">/usr/local/awstats/tools/logresolvemerge.pl /home/logs/bbs/*.log |</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span></pre>
</div>
<h4 style="padding:0px;color:rgb(0, 0, 0);font-size:14px;font-weight:bold;margin:10px 0px;"> </h4>
<h4 style="padding:0px;color:rgb(0, 0, 0);font-size:14px;font-weight:bold;margin:10px 0px;">2.4 生成静态统计结果</h4>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;">2.4.1 更新所有站点数据文件</p>
<div style="background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);padding:5px;overflow:auto;margin:5px 0px;color:rgb(0, 0, 0);font-family:Courier New;font-size:12px;">
<pre style="margin:0px;padding:0px;margin-top:0px;margin-bottom:0px;overflow-wrap:break-word;white-space:pre-wrap;font-family:Courier New;font-size:12px;">/usr/local/awstats/tools/awstats_updateall.pl now -awstatsprog=/usr/local/awstats/wwwroot/cgi-bin/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">awstats.pl
#这个脚本会更新所有站点配置文件，默认从</span>/etc/awstats目录寻找，如果你配置文件不在/etc/awstats目录，则需要指定目录</pre>
</div>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;">2.4.2 另一种方法是直接使用awstats.pl脚本，逐个站点进行更新</p>
<div style="background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);padding:5px;overflow:auto;margin:5px 0px;color:rgb(0, 0, 0);font-family:Courier New;font-size:12px;">
<pre style="margin:0px;padding:0px;margin-top:0px;margin-bottom:0px;overflow-wrap:break-word;white-space:pre-wrap;font-family:Courier New;font-size:12px;">/usr/bin/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">perl</span> /usr/local/awstats/wwwroot/cgi-bin/awstats.pl -update -config=www.test.com -configdir=/etc/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">awstats
</span>/usr/bin/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">perl</span> /usr/local/awstats/wwwroot/cgi-bin/awstats.pl -update -config=bbs.test.com -configdir=/etc/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">awstats
</span>-configdir: 这个参数是可选</pre>
</div>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;">2.4.3 生成静态html统计页面</p>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;">上面2.4.1或2.4.2都可以统计日志，把结果更新到数据文件，下面是根据数据文件生成最终可以用web访问的html</p>
<div style="background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);padding:5px;overflow:auto;margin:5px 0px;color:rgb(0, 0, 0);font-family:Courier New;font-size:12px;">
<pre style="margin:0px;padding:0px;margin-top:0px;margin-bottom:0px;overflow-wrap:break-word;white-space:pre-wrap;font-family:Courier New;font-size:12px;">/usr/local/awstats/tools/awstats_buildstaticpages.pl -config=www.test.com -lang=cn -awstatsprog=/usr/local/awstats/wwwroot/cgi-bin/awstats.pl -<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">dir</span>=/home/awstats/web/
/usr/local/awstats/tools/awstats_buildstaticpages.pl -config=bbs.test.com -lang=cn -awstatsprog=/usr/local/awstats/wwwroot/cgi-bin/awstats.pl -<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">dir</span>=/home/awstats/web/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">
#</span>/home/awstats/web 为html存放目录</pre>
</div>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;">2.4.4 配置web访问</p>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;">我们使用nginx作为web服务器，下面配置一个虚拟主机，nginx配置虚拟主机方法请自行搜索</p>
<div style="background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);padding:5px;overflow:auto;margin:5px 0px;color:rgb(0, 0, 0);font-family:Courier New;font-size:12px;"><div style="margin:0px;padding:0px;margin-top:5px;background-color:rgb(245, 245, 245);"><span style="margin:0px;padding:0px;padding-right:5px;font-family:Courier New;font-size:12px;line-height:1.5;"><a href="#" style="margin:0px;padding:0px;text-decoration:none;color:rgb(0, 0, 0);border-bottom:1px dotted rgb(51, 51, 51);background-color:rgb(245, 245, 245);border:medium none;" title="复制代码"><img src="awstats_files/copycode [10].gif" type="image/gif" data-filename="copycode.gif" alt="复制代码" height="20" style="margin:0px;padding:0px;height:auto;max-width:300px;border:medium none;background-color:rgb(245, 245, 245);" width="20"/></a></span></div>
<pre style="margin:0px;padding:0px;margin-top:0px;margin-bottom:0px;overflow-wrap:break-word;white-space:pre-wrap;font-family:Courier New;font-size:12px;">#<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#0000ff;">cat</span> /usr/local/nginx/conf/vhosts/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">awstats.conf
server {
    listen       </span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800080;">8081</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">;
    server_name  </span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800080;">192.168</span>.<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800080;">0.107</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">;
    auth_basic </span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">admin</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#800000;">&quot;</span><span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">;
    auth_basic_user_file </span>/usr/local/nginx/conf/vhosts/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">admin.pass;
    access_log  </span>/home/logs/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">awstats.www.test.com.access.log;
    root </span>/home/awstats/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">web;    #html存放目录
    index index.html;

    location </span>/awstats/classes/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;"> {
        alias </span>/usr/local/awstats/wwwroot/classes/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">;
    }

    location </span>/awstats/css/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;"> {
        alias </span>/usr/local/awstats/wwwroot/css/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">;
    }

    location </span>/awstats/icon/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;"> {
        alias </span>/usr/local/awstats/wwwroot/icon/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">;
    }

    location </span>/awstats-icon/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;"> {
        alias </span>/usr/local/awstats/wwwroot/icon/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">;
    }

    location </span>/awstats/js/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;"> {
        alias </span>/usr/local/awstats/wwwroot/js/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">;
    }

    location </span>/awstatsicons/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;"> {
        alias </span>/usr/local/awstats/wwwroot/icon/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">;
    }
 
    location </span>~ ^/icon/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;"> 
{
        root   </span>/usr/local/awstats/<span style="margin:0px;padding:0px;font-family:Courier New;font-size:12px;line-height:1.5;color:#000000;">wwwroot;
        index  index.html;
        access_log off;
        error_log off;
    }
}</span></pre>
<div style="margin:0px;padding:0px;margin-top:5px;background-color:rgb(245, 245, 245);"><span style="margin:0px;padding:0px;padding-right:5px;font-family:Courier New;font-size:12px;line-height:1.5;"><a href="#" style="margin:0px;padding:0px;text-decoration:none;color:rgb(0, 0, 0);border-bottom:1px dotted rgb(51, 51, 51);background-color:rgb(245, 245, 245);border:medium none;" title="复制代码"><img src="awstats_files/copycode [11].gif" type="image/gif" data-filename="copycode.gif" alt="复制代码" height="20" style="margin:0px;padding:0px;height:auto;max-width:300px;border:medium none;background-color:rgb(245, 245, 245);" width="20"/></a></span></div></div>
<p style="padding:0px;margin-bottom:0px;margin-top:12px;margin:10px auto;text-indent:0px;"> </p></div>
<div style="margin:0px;padding:0px;clear:both;"></div>
<div style="margin:0px;padding:0px;margin-top:20px;">
<div style="margin:0px;padding:0px;margin-bottom:10px;">分类: <a href="http://www.cnblogs.com/jython/category/788050.html" style="margin:0px;padding:0px;text-decoration:none;color:rgb(0, 0, 0);border-bottom:1px dotted rgb(51, 51, 51);" target="_blank">web</a></div>
<div style="margin:0px;padding:0px;font-size:9pt;color:gray;margin-top:0px;">标签: <a href="http://www.cnblogs.com/jython/tag/awstat/" style="margin:0px;padding:0px;text-decoration:none;color:rgb(0, 0, 0);border-bottom:1px dotted rgb(51, 51, 51);">awstat</a>, <a href="http://www.cnblogs.com/jython/tag/nginx%20log/" style="margin:0px;padding:0px;text-decoration:none;color:rgb(0, 0, 0);border-bottom:1px dotted rgb(51, 51, 51);">nginx log</a></div>
<div style="margin:0px;padding:0px;"><div style="margin:0px;padding:10px 0px;margin-bottom:10px;margin-top:10px;border:1px dashed silver;font-size:12px;width:320px;text-align:center;">
        <a href="#" style="margin:0px;border-bottom:1px dotted rgb(51, 51, 51);background:rgba(0, 0, 0, 0) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAkCAYAAABIdFAMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHhJREFUeNo8zjsOxCAMBFB/KEAUFFR0Cbng3nQPw68ArZdAlOZppPFIBhH5EAB8b+Tlt9MYQ6i1BuqFaq1CKSVcxZ2Acs6406KUgpt5/LCKuVgz5BDCSb13ZO99ZOdcZGvt4mJjzMVKqcha68iIePB86GAiOv8CDADlIUQBs7MD3wAAAABJRU5ErkJggg%3D%3D&quot;) repeat-x scroll 0% 0%;display:inline-block;padding:3px 8px;text-decoration:none;font-weight:bold;cursor:pointer;margin-right:10px;border-radius:10px;box-shadow:rgba(0, 0, 0, 0.5) 0px 1px 3px;text-shadow:rgba(0, 0, 0, 0.25) 0px -1px 1px;vertical-align:middle;background-color:rgb(45, 174, 191);color:rgb(255, 255, 255);border:medium none;">好文要顶</a>
            <a href="#" style="margin:0px;border-bottom:1px dotted rgb(51, 51, 51);background:rgba(0, 0, 0, 0) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAkCAYAAABIdFAMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHhJREFUeNo8zjsOxCAMBFB/KEAUFFR0Cbng3nQPw68ArZdAlOZppPFIBhH5EAB8b+Tlt9MYQ6i1BuqFaq1CKSVcxZ2Acs6406KUgpt5/LCKuVgz5BDCSb13ZO99ZOdcZGvt4mJjzMVKqcha68iIePB86GAiOv8CDADlIUQBs7MD3wAAAABJRU5ErkJggg%3D%3D&quot;) repeat-x scroll 0% 0%;display:inline-block;padding:3px 8px;text-decoration:none;font-weight:bold;cursor:pointer;margin-right:10px;border-radius:10px;box-shadow:rgba(0, 0, 0, 0.5) 0px 1px 3px;text-shadow:rgba(0, 0, 0, 0.25) 0px -1px 1px;vertical-align:middle;background-color:rgb(227, 49, 0);color:rgb(255, 255, 255);border:medium none;">关注我</a>
    <a href="#" style="margin:0px;border-bottom:1px dotted rgb(51, 51, 51);background:rgba(0, 0, 0, 0) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAkCAYAAABIdFAMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHhJREFUeNo8zjsOxCAMBFB/KEAUFFR0Cbng3nQPw68ArZdAlOZppPFIBhH5EAB8b+Tlt9MYQ6i1BuqFaq1CKSVcxZ2Acs6406KUgpt5/LCKuVgz5BDCSb13ZO99ZOdcZGvt4mJjzMVKqcha68iIePB86GAiOv8CDADlIUQBs7MD3wAAAABJRU5ErkJggg%3D%3D&quot;) repeat-x scroll 0% 0%;display:inline-block;padding:3px 8px;text-decoration:none;font-weight:bold;cursor:pointer;margin-right:10px;border-radius:10px;box-shadow:rgba(0, 0, 0, 0.5) 0px 1px 3px;text-shadow:rgba(0, 0, 0, 0.25) 0px -1px 1px;vertical-align:middle;background-color:rgb(255, 181, 21);color:rgb(255, 255, 255);border:medium none;">收藏该文</a>
    <a href="#" style="margin:0px;border-bottom:1px dotted rgb(51, 51, 51);display:inline-block;text-decoration:none;font-weight:bold;cursor:pointer;margin-right:10px;border-radius:10px;vertical-align:middle;background:rgba(0, 0, 0, 0) none repeat scroll 0% 0%;padding:3px 2px;box-shadow:none;text-shadow:none;color:rgb(255, 255, 255);border:medium none;" title="分享至新浪微博"><img src="awstats_files/icon_weibo_24.png" type="image/png" data-filename="icon_weibo_24.png" alt="" height="24" style="margin:0px;padding:0px;height:auto;border:medium none;vertical-align:middle;margin-left:5px;box-shadow:none;max-width:300px;" width="24"/></a>
    <a href="#" style="margin:0px;border-bottom:1px dotted rgb(51, 51, 51);display:inline-block;text-decoration:none;font-weight:bold;cursor:pointer;margin-right:10px;border-radius:10px;vertical-align:middle;background:rgba(0, 0, 0, 0) none repeat scroll 0% 0%;padding:3px 2px;box-shadow:none;text-shadow:none;color:rgb(255, 255, 255);border:medium none;" title="分享至微信"><img src="awstats_files/wechat.png" type="image/png" data-filename="wechat.png" alt="" height="24" style="margin:0px;padding:0px;border:medium none;width:24px;height:24px;box-shadow:none;margin-left:5px;vertical-align:middle;max-width:300px;" width="24"/></a>
</div>
<div style="margin:0px;padding:0px;float:left;width:280px;margin-top:0px;margin-bottom:10px;color:rgb(0, 0, 0);margin-left:0px;font-size:12px;">
    <div style="margin:0px;padding:0px;float:left;line-height:18px;">
            <a href="http://home.cnblogs.com/u/jython/" style="margin:0px;padding:0px;text-decoration:none;color:rgb(0, 0, 0);border-bottom:1px dotted rgb(51, 51, 51);" target="_blank"><img src="awstats_files/20150504131833.png.jpg" type="image/jpeg" data-filename="20150504131833.png.jpg" alt="" height="48" style="margin:0px;padding:0px;height:auto;border:0px none;vertical-align:top;float:left;margin-right:5px;padding-top:5px;padding-left:2px;max-width:300px;" width="48"/></a>
        <div style="margin:0px;padding:0px;float:left;line-height:18px;">
            <a href="http://home.cnblogs.com/u/jython/" style="margin:0px;padding:0px;text-decoration:none;color:rgb(0, 0, 0);border-bottom:1px dotted rgb(51, 51, 51);">jython.li</a><br style="margin:0px;padding:0px;"/>
            <a href="http://home.cnblogs.com/u/jython/followees" style="margin:0px;padding:0px;text-decoration:none;color:rgb(0, 0, 0);border-bottom:1px dotted rgb(51, 51, 51);">关注 - 1</a><br style="margin:0px;padding:0px;"/>
            <a href="http://home.cnblogs.com/u/jython/followers" style="margin:0px;padding:0px;text-decoration:none;color:rgb(0, 0, 0);border-bottom:1px dotted rgb(51, 51, 51);">粉丝 - 1</a>
        </div>
    </div>
    <div style="margin:0px;padding:0px;clear:both;"></div>
    <div style="margin:0px;padding:0px;"></div>
    <div style="margin:0px;padding:0px;">
                <a href="#" style="margin:0px;padding:0px;text-decoration:none;color:rgb(0, 0, 0);border-bottom:1px dotted rgb(51, 51, 51);">+加关注</a>
    </div>
</div>
<div style="margin:0px;padding:0px;float:right;margin-bottom:10px;margin-right:30px;font-size:12px;width:125px;text-align:center;margin-top:10px;">
    <div style="margin:0px;padding:0px;float:left;width:46px;height:52px;background:rgba(0, 0, 0, 0) url(&quot;//static.cnblogs.com/images/upup.gif&quot;) no-repeat scroll 0% 0%;text-align:center;cursor:pointer;margin-top:2px;padding-top:5px;">
        <span style="margin:0px;padding:0px;font-size:14px;color:rgb(7, 93, 179);font-family:Verdana;line-height:1.5em;">0</span>
    </div>
    <div style="margin:0px;padding:0px;float:right;margin-left:20px;width:46px;height:52px;background:rgba(0, 0, 0, 0) url(&quot;//static.cnblogs.com/images/downdown.gif&quot;) no-repeat scroll 0% 0%;text-align:center;cursor:pointer;margin-top:2px;padding-top:5px;">
        <span style="margin:0px;padding:0px;font-size:14px;color:rgb(7, 93, 179);font-family:Verdana;line-height:1.5em;">0</span>
    </div>
    <div style="margin:0px;padding:0px;clear:both;"></div>
    <div style="margin:0px;padding:0px;margin-top:5px;margin-left:0px;font-size:12px;color:gray;">
    </div>
</div>
</div>
<div style="margin:0px;padding:0px;clear:both;"></div>
<div style="margin:0px;padding:0px;line-height:1.8;font-size:12px;"><a href="http://www.cnblogs.com/jython/p/5396523.html" style="margin:0px;padding:0px;color:rgb(0, 0, 0);border-bottom:1px dotted rgb(51, 51, 51);text-decoration:none;">« </a> 上一篇：<a href="http://www.cnblogs.com/jython/p/5396523.html" style="margin:0px;padding:0px;text-decoration:none;color:rgb(0, 0, 0);border-bottom:1px dotted rgb(51, 51, 51);" title="发布于2016-04-19 15:48">kvm虚拟化环境中的时区设置</a><br style="margin:0px;padding:0px;"/></div>
</div>


		</div>
		<div style="margin:0px;padding:0px;border-bottom:1px dotted rgb(153, 153, 153);color:rgb(153, 153, 153);text-align:right;padding-bottom:20px;">posted @ <span style="margin:0px;padding:0px;">2016-04-23 17:07</span> <a href="http://www.cnblogs.com/jython/" style="margin:0px;padding:0px;text-decoration:none;color:rgb(51, 51, 51);">jython.li</a> 阅读(<span style="margin:0px;padding:0px;">2091</span>) 评论(<span style="margin:0px;padding:0px;">0</span>)  <a href="https://i.cnblogs.com/EditPosts.aspx?postid=5425038" rel="nofollow" style="margin:0px;padding:0px;text-decoration:none;color:rgb(51, 51, 51);">编辑</a> <a href="https://www.cnblogs.com/jython/p/5425038.html#" style="margin:0px;padding:0px;text-decoration:none;color:rgb(51, 51, 51);">收藏</a></div>
	</div></div></div></div></div></div></div></div></div></div><br/></div></span>
</div></body></html> 