<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307027 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="3802"/>

<div>
<span><div style="-evernote-webclip:true;"><div><br/></div><div style="box-sizing: border-box; font-size: 10px;"><div style="box-sizing: border-box; font-size: 14px; background-color: rgb(255, 255, 255);"><div style="box-sizing:border-box;"><div style="box-sizing:border-box;"><div style="box-sizing:border-box;"><div style="box-sizing:border-box;"><div style="box-sizing:border-box;padding:30px 0px 0px;padding-top:0px;"><div style="box-sizing:border-box;margin-bottom:20px;"><div style="box-sizing:border-box;"><div style="box-sizing:border-box;margin-left:-15px;margin-right:-15px;"><div style="box-sizing:border-box;position:relative;min-height:1px;padding-left:15px;padding-right:15px;float:left;width:100%;"><div style="box-sizing: border-box; margin-bottom: -5px; margin-left: 0px;"><div style="box-sizing:border-box;"><div style="box-sizing:border-box;"><div><a href="https://segmentfault.com/u/shuaizhen" style="box-sizing: border-box; background: none 0% 0% repeat scroll transparent; outline: currentcolor none 0px; float: left; padding-right: 10px; font-size: 14px; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; line-height: 1.42858; color: rgb(0, 154, 97); text-decoration: none;"><img src="keepalived_files/2751436092-5965740030852_big64.jpg" type="image/jpeg" data-filename="2751436092-5965740030852_big64.jpg" alt="济贞" height="40" style="box-sizing:border-box;border:0px none;vertical-align:middle;border-radius:50%;width:40px;height:40px;" width="40"/></a> <a href="https://segmentfault.com/u/shuaizhen" style="box-sizing: border-box; background: none 0% 0% repeat scroll transparent; outline: currentcolor none 0px; margin-right: 5px;"></a><a href="https://segmentfault.com/u/shuaizhen" style="font-size: 14px; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; line-height: 1.42858; background-color: transparent; color: rgb(0, 154, 97); text-decoration: none; font-weight: bold; box-sizing: border-box;">济贞</a></div><div style="box-sizing: border-box;"><span style="font-size: 14px; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(153, 153, 153); line-height: 1.42858;">2017年09月08日  ·  15.3k 次阅读</span></div></div></div><h1 style="box-sizing: border-box; margin: 15px 0px 20px; font-size: 34px;"><a href="https://segmentfault.com/a/1190000011078937" style="box-sizing: border-box; background: none 0% 0% repeat scroll transparent; outline: currentcolor none 0px; font-size: 34px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; line-height: 48px; font-weight: 500; color: rgb(51, 51, 51); text-decoration: none;">KeepAlive--高可用解决方案</a></h1><div style="box-sizing:border-box;"><span style="margin-left: 0px; font-size: 13px; height: 22px; padding: 0px 6px; border-radius: 11px; margin-right: 10px; background-color: rgba(242, 174, 67, 0.25); font-family: &quot;PingFang SC&quot;; color: rgb(242, 174, 67); line-height: 22px; font-weight: normal;">原</span> <a href="https://segmentfault.com/t/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/blogs" style="box-sizing: border-box; background: none 0% 0% repeat scroll rgba(1, 126, 102, 0.08); outline: currentcolor none 0px; padding: 0px 6px; height: 22px; font-size: 13px; text-align: center; font-family: -apple-system, &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; line-height: 22px; color: rgb(1, 126, 102); font-weight: normal; text-decoration: none;">负载均衡</a> <span style="margin-left: 10px; font-size: 13px; height: 22px; padding: 0px 6px; border-radius: 11px; background-color: rgba(242, 174, 67, 0.25); font-family: &quot;PingFang SC&quot;; color: rgb(242, 174, 67); line-height: 22px; font-weight: normal;">原</span></div></div></div></div></div></div></div><div style="box-sizing: border-box; overflow-wrap: break-word; margin-top: 60px; font-size: 15px;"><h1 style="box-sizing: border-box; font-size: 2em; margin: 0px; border-bottom: 1px solid rgb(238, 238, 238); padding-bottom: 10px;"><span style="font-size: 2em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.75em; font-weight: 500;">一：keepalive简述</span></h1><h2 style="box-sizing: border-box; font-size: 1.75em; margin: 1.5em 0px 0px; border-bottom: 1px solid rgb(238, 238, 238); padding-bottom: 10px;"><span style="font-size: 1.75em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.5em; font-weight: 500;">一;高可用的解决方案</span></h2><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">1）vrrp协议的实现</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">keepalive</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">2）ais：完备HA集群</span></div></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">RHCS（cman）</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">heartbeat</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">corosync</span></div></div><h2 style="box-sizing: border-box; font-size: 1.75em; margin: 1.5em 0px 0px; border-bottom: 1px solid rgb(238, 238, 238); padding-bottom: 10px;"><span style="font-size: 1.75em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.5em; font-weight: 500;">二：vrrp协议：</span></h2><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">概念：在节点（主机）出现故障时，实现ip地址的切换。</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">keepalive就是基于此协议而实现高可用的。</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">Failover：故障切换，即某资源的主节点故障时，将资源转移至其它节点的操作；</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">Failback：故障移回，即某资源的主节点故障后重新修改上线后，将转移至其它节点的资源重新切回的过程；</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">术语：</span></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">虚拟路由器：Virtual Router</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">对应与配置文件中/etc/keepalived中的virtual_ipaddress</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">生产中一个director主机上通常会有多个网卡，对外为vip1，接收用户请求，对内为vip2，将用户的请求通过vip2发送给后端提供服务的主机RS。在配置虚拟路由ip时。vip1与vip2需要配置在一个组内，实现在master主机出现故障时，vip1转向backup备用主机时，vip2也同时转向backup备用主机。不然vip2还停留在master主机上，转向后端主机的请求将会无法到达。</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">此块在配置文件中</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">虚拟路由器标识：VRID(0-255)</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">物理路由器：</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">master：主设备</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">backup：备用设备</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">priority：优先级</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">VIP：Virtual IP，虚拟ip</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">VMAC：Virutal MAC (00-00-5e-00-01-VRID)</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">GraciousARP</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">通告：心跳，优先级等；周期性；</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">抢占式，非抢占式；</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">安全工作：</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">认证：</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">无认证</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">简单字符认证</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">MD5</span></div></div><h2 style="box-sizing: border-box; font-size: 1.75em; margin: 1.5em 0px 0px; border-bottom: 1px solid rgb(238, 238, 238); padding-bottom: 10px;"><span style="font-size: 1.75em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.5em; font-weight: 500;">三：keepalived:</span></h2><h3 style="box-sizing: border-box; font-size: 1.5em; margin: 1.5em 0px 0px;"><span style="font-size: 1.5em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.25em; font-weight: 500;">1：简述</span></h3><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 1.5em 0px; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">vrrp协议的软件实现，原生设计的目的为了高可用ipvs服务：</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">基于vrrp协议完成地址流动；</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">为集群内的所有节点生成ipvs规则（在配置文件中预先定义）；</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">为ipvs集群的各</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">RS</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">做健康状态检测；</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">基于脚本调用接口通过执行脚本完成脚本中定义的功能，进而影响集群事务；</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">组件：</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">核心组件：</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">vrrp stack vrrp协议的实现</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">ipvs wrapper为集群内的所有节点生成ipvs规则</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">checkers 为ipvs集群的各</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">RS</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">做健康状态检测</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">控制组件：</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">配置文件分析器</span></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">IO复用器</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">内存管理组件</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">虚拟路由器的工作模型：</span></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">单主：</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">双主</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">通知机制：</span></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">notify_master</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">notify_backup</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">notify_fault</span></div></div><h3 style="box-sizing: border-box; font-size: 1.5em; margin: 1.5em 0px 0px;"><span style="font-size: 1.5em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.25em; font-weight: 500;">2：安装</span></h3><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">yum install keepalived</span></div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">程序环境：</span></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">主配置文件：/etc/keepalived/keepalived.conf</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">主程序文件：/usr/sbin/keepalived</span></div><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">Unit</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">File</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">：keepalived.service</span></div><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">Unit</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">File</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">的环境配置文件：/etc/sysconfig/keepalived</span></div></div><h3 style="box-sizing: border-box; font-size: 1.5em; margin: 1.5em 0px 0px;"><span style="font-size: 1.5em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.25em; font-weight: 500;">3：配置文件</span></h3><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">/etc/keepalived/keepalived.conf</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">配置文件组件部分：</span></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">TOP HIERACHY</span></div><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">GLOBAL</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">CONFIGURATION</span></div><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">Global</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">definitions</span></div><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">Static</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">routes/addresses</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">VRRPD CONFIGURATION</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">VRRP synchronization</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">group</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">(s)：vrrp同步组；</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">VRRP instance(s)：每个vrrp instance即一个vrrp路由器；</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">LVS CONFIGURATION</span></div><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">Virtual</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">server</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">group</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">(s)</span></div><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">Virtual</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">server(s)：ipvs集群的vs和rs；</span></div></div><h3 style="box-sizing: border-box; font-size: 1.5em; margin: 1.5em 0px 0px;"><span style="font-size: 1.5em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.25em; font-weight: 500;">4：man keepalived.conf</span></h3><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">可以查看配置文件的具体使用细则</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">第一个配置段：GLOBAL CONFIGURATION</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">第二配置段：VRRPD CONFIGURATION</span></div></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: initial;">此地址段为配置keepalived的核心配置段。主要包括两块内容</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">VRRP instance(s)：vrrp实例</span></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: initial;">一个vrrp</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">instance</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: initial;">就是一个vrrp路由器</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">VRRP synchronization group(s)：虚拟路由器同步组</span></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">一个主机生产中一般需要配置两个以上的虚拟路由器。此配置可以实现将多个虚拟路由器编制在一个组内，可以实现，当一个虚拟路由器偏移至另一台主机时，其余的虚拟路由器（vip）也同时偏移至另一台主机上。</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">inside_network # name of vrrp_instance (below) 内网网络</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">outside_network # One for each moveable IP. 外网网络</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><img src="keepalived_files/Image.png" type="image/png" data-filename="Image.png" alt="clipboard.png" height="297" style="box-sizing:border-box;vertical-align:middle;border:medium none;max-width:100%;padding:3px;position:static;cursor:pointer;display:inline;" title="clipboard.png" width="554"/></span></div><div><br style="box-sizing:border-box;"/></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">第三段：LVS CONFIGURATION</span></div></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: initial;">高可用LVS时使用。若使用Nginx时不用关注此块</span></div><h2 style="box-sizing: border-box; font-size: 1.75em; margin: 1.5em 0px 0px; border-bottom: 1px solid rgb(238, 238, 238); padding-bottom: 10px;"><span style="font-size: 1.75em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.5em; font-weight: 500;">四：配置语法：</span></h2><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 1.5em 0px; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">配置虚拟路由器：</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">vrrp_instance</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">&lt;STRING&gt;</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">{</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">....</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">}</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">专用参数：</span></div><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">state</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">MASTER|BACKUP：当前节点在此虚拟路由器上的初始状态；只能有一个是MASTER，余下的都应该为BACKUP；</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">interface IFACE_NAME：绑定为当前虚拟路由器使用的物理接口；</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">virtual_router_id VRID：当前虚拟路由器的惟一标识，范围是</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">0</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">-</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">255</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">；</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">priority</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">100</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">：当前主机在此虚拟路径器中的优先级；范围</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">1</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">-</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">254</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">；</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">advert_int</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">1</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">：vrrp通告的时间间隔；</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">authentication {</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">auth_type AH|PASS</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">auth_pass</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">&lt;PASSWORD&gt;</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">}</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">virtual_ipaddress {</span></div><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">&lt;IPADDR&gt;</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">/</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">&lt;MASK&gt;</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">brd</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">&lt;IPADDR&gt;</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">dev</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">&lt;STRING&gt;</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">scope</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">&lt;SCOPE&gt;</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">label</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">&lt;LABEL&gt;</span></div><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">192.168</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">.</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">200.17</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">/</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">24</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">dev eth1</span></div><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">192.168</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">.</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">200.18</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">/</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">24</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">dev eth2</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">label</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">eth2:</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">1</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">}</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">track_interface {</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">eth0</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">eth1</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">...</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">}</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">配置要监控的网络接口，一旦接口出现故障，则转为FAULT状态；</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">nopreempt：定义工作模式为非抢占模式；</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">preempt_delay</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">300</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">：抢占式模式下，节点上线后触发新选举操作的延迟时长；</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">定义通知脚本：</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">notify_master</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">&lt;STRING&gt;</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">|</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">&lt;QUOTED-STRING&gt;</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">：当前节点成为主节点时触发的脚本</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">notify_backup</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">&lt;STRING&gt;</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">|</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">&lt;QUOTED-STRING&gt;</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">：当前节点转为备节点时触发的脚本；</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">notify_fault</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">&lt;STRING&gt;</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">|</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">&lt;QUOTED-STRING&gt;</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">：当前节点转为“失败”状态时触发的脚本；</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">notify</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">&lt;STRING&gt;</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">|</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">&lt;QUOTED-STRING&gt;</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">：通用格式的通知触发机制，一个脚本可完成以上三种状态的转换时的通知；</span></div></div><h2 style="box-sizing: border-box; font-size: 1.75em; margin: 1.5em 0px 0px; border-bottom: 1px solid rgb(238, 238, 238); padding-bottom: 10px;"><span style="font-size: 1.75em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.5em; font-weight: 500;">五：通知机制</span></h2><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">通知机制：</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">notify_master：to be master时，调用指定的脚本完成辅助操作，，以“通知”为核心目标</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">notify_backup to be backup时，调用指定的脚本完成辅助操作，，以“通知”为核心目标</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">notify_fault</span></div></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">通知脚本的使用方式：</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">示例通知脚本：</span></div><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); font-style: normal;">#!/bin/bash</span></div><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); font-style: normal;">#</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">contact=</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">'root@localhost'</span></div><div><br/></div><div><span style="box-sizing:border-box;"><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">notify</span></span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">() {</span></div><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">local</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">mailsubject=</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">&quot;</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">$(hostname)</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">to be</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">$1</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">, vip floating&quot;</span></div><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">local</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">mailbody=</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">&quot;</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">$(date +'%F %T')</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">: vrrp transition,</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">$(hostname)</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">changed to be</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">$1</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">&quot;</span></div><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">echo</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">&quot;</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">$mailbody</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">&quot;</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">| mail</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">-s</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">&quot;</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">$mailsubject</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">&quot;</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">$contact</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">}</span></div><div><br/></div><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">case</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">$1</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">in</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">master)</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">notify master</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">;;</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">backup)</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">notify backup</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">;;</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">fault)</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">notify fault</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">;;</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">*)</span></div><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">echo</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">&quot;Usage:</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">$(basename $0)</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">{master|backup|fault}&quot;</span></div><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">exit</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">1</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">;;</span></div><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">esac</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">脚本的调用方法：</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">notify_master</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">&quot;/etc/keepalived/notify.sh master&quot;</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">notify_backup</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">&quot;/etc/keepalived/notify.sh backup&quot;</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">notify_fault</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">&quot;/etc/keepalived/notify.sh fault&quot;</span></div></div><h2 style="box-sizing: border-box; font-size: 1.75em; margin: 1.5em 0px 0px; border-bottom: 1px solid rgb(238, 238, 238); padding-bottom: 10px;"><span style="font-size: 1.75em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.5em; font-weight: 500;">六：D类地址</span></h2><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">D类IP地址第一个字节以“1110”开始 。它并不指向特定的网络，目前这一类地址被用在多点广播（Multicast）中。多点广播地址用来一次寻址一组计算机，它标识共享同一协议的一组计算机。</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">D类地址又分为三种类型：即专用地址、公用地址和私用地址；其中专用地址（224.0.0.0-224.0.0.255）用于网络协议组的广播，公用地址（224.0.1.0-238.255.255.255）用于其它组播，私用地址（239.0.0.0-239.255.255.255）用于测试。</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">在keepdlived的配置文件中</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">vrrp_mcast_group4 224.24.24.18</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">此地址用于向共同使用vrrp协议的主机 不断的广播自身的ip地址，及优先级。优先级高的主机将会使用vip</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">在现实中，会使用一根网线将 此两台主机直接绑定在一起，实现此类功能</span></div><h1 style="box-sizing: border-box; font-size: 2em; margin: 1.5em 0px 0px; border-bottom: 1px solid rgb(238, 238, 238); padding-bottom: 10px;"><span style="font-size: 2em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.75em; font-weight: 500;">二：实现</span></h1><h1 style="box-sizing: border-box; font-size: 2em; margin: 1.5em 0px 0px; border-bottom: 1px solid rgb(238, 238, 238); padding-bottom: 10px;"><span style="font-size: 2em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.75em; font-weight: 500;">一：配置前提</span></h1><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">HA Cluster的配置前提：</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">(1) 各节点时间必须同步；</span></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">ntp, chrony</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">(</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">2</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">) 确保iptables及selinux不会成为阻碍；</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">(</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">3</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">) 各节点之间可通过主机名互相通信（对KA并非必须）；</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">建议使用/etc/hosts文件实现；</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">(</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">4</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">) 确保各节点的用于集群服务的接口支持MULTICAST通信；</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">D类：</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">224</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">-239</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">；</span></div></div><h2 style="box-sizing: border-box; font-size: 1.75em; margin: 1.5em 0px 0px; border-bottom: 1px solid rgb(238, 238, 238); padding-bottom: 10px;"><span style="font-size: 1.75em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.5em; font-weight: 500;">二：实验前奏</span></h2><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">keepalive天生是用来高可用LVS的。借助服务脚本接口可以实现高可用nginx和haproxy</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">第一步：单主模型</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">vrrp的地址转移实现。单主模式。一个虚拟路由vip</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">第二步：双主模型</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">实现双主节点，每一个节点都可以工作起来。双虚拟路由ip</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">第三步：高可用LVS</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">在单主模式下。增加后端的具体服务。实现节点切换时，服务仍然可用。</span></div></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: initial;">后端的服务为两台主机，</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">第四步：增加check。检查后端主机的健康状况。</span></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: initial;">在后端主机全部down掉的情况之下，增加sorry</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">server</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: initial;">.用keepalive主机实现</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">第五步：高可用haproxy</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">keepalive主机不再使用LVS（director）。使用nginx或者haproxy</span></div></div><h2 style="box-sizing: border-box; font-size: 1.75em; margin: 1.5em 0px 0px; border-bottom: 1px solid rgb(238, 238, 238); padding-bottom: 10px;"><span style="font-size: 1.75em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.5em; font-weight: 500;">三：keepalive 单主模式</span></h2><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">环境：172.16.253.95 做master</span></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: initial;">172</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">.16</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">.253</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">.96</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: initial;">做</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">backup</span></div><h3 style="box-sizing: border-box; font-size: 1.5em; margin: 1.5em 0px 0px;"><span style="font-size: 1.5em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.25em; font-weight: 500;">1：解读配置文件</span></h3><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">再解读/etc/keepalived/keepalived.conf</span></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: initial;">全局配置</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">global_defs {</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">notification_email {</span></div></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: initial;">haha@mashuai</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">.com</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); font-style: normal;">//出问题时，接收邮件的地址</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">}</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">notification_email_from admin@mashuai.com //邮件发件人地址</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">smtp_server 127.0.0.1 //邮件服务器地址</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">smtp_connect_timeout 30 //连接超时时间</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">router_id n2 //虚拟路由服务器地址（建议写上主机名）</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">vrrp_mcast_group4 224.24.24.18 //多播地址段，默认为224.0.0.18.做实验时需要更改</span></div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">}</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">vrrp_instance vrrp实例段，核心配置段</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">vrrp_instance VI_1 { //虚拟路由器的名称，多个时，名称要不一样</span></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">state</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">MASTER</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); font-style: normal;">//虚拟路由器的状态，master|backup</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">interface eth0</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); font-style: normal;">//通过哪个网口发送vrrp广播</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">virtual_router_id</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">01</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); font-style: normal;">//虚拟路由器的id，要与同一台主机上的其他虚拟路由器id 区分开来</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">priority</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">100</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); font-style: normal;">//物理路由器在此虚拟路由器上的优先级</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">advert_int</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">1</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); font-style: normal;">//每隔多长时间 广播一次自己的优先级</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">authentication {</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); font-style: normal;">//传递信息的认证方式，密码仅支持8位</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">auth_type PASS</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">auth_pass</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">1111</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">}</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">virtual_ipaddress {</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); font-style: normal;">//虚拟路由的ip地址</span></div><div><code style="box-sizing: border-box; padding: 0px; border-radius: 0px; font-size: 1em; white-space: inherit; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); overflow-wrap: normal;"><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">172.16</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">.253</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">.100</span></code></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">}</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">}</span></div><h3 style="box-sizing: border-box; font-size: 1.5em; margin: 1.5em 0px 0px;"><span style="font-size: 1.5em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.25em; font-weight: 500;">2：更改配置文件</span></h3><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">95主机的配置文件</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">注意：绿色字体为与96主机不一样的地方。</span></div></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: initial;">其他的配置文件内容统统都注释掉</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">global_defs {</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">notification_email {</span></div></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">haha</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: initial;">@</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">mashuai</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: initial;">.</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">com</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">}</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">notification_email_from Alexandre.Cassen@firewall.loc</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">smtp_server 127.0.0.1</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">smtp_connect_timeout 30</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">router_id LVS_DEVEL</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">vrrp_mcast_group4 224.24.24.18</span></div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">}</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">vrrp_instance VI_1 {</span></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">state</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">MASTER</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">interface eth0</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">virtual_router_id</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">01</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">priority</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">100</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">advert_int</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">1</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">authentication {</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">auth_type PASS</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">auth_pass</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">1111</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">}</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">virtual_ipaddress {</span></div><div><code style="box-sizing: border-box; padding: 0px; border-radius: 0px; font-size: 1em; white-space: inherit; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); overflow-wrap: normal;"><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">172.16</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">.253</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">.100</span></code></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">}</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">}</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">96主机的配置文件</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">global_defs {</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">notification_email {</span></div></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">haha</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: initial;">@</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">mashuai</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: initial;">.</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">com</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">}</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">notification_email_from Alexandre.Cassen@firewall.loc</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">smtp_server 127.0.0.1</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">smtp_connect_timeout 30</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">router_id n2</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">vrrp_mcast_group4 224.24.24.18</span></div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">}</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">vrrp_instance VI_1 {</span></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">state</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">BACKUP</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">interface eth0</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">virtual_router_id</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">01</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">priority</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">95</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">advert_int</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">1</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">authentication {</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">auth_type PASS</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">auth_pass</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">1111</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">}</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">virtual_ipaddress {</span></div><div><code style="box-sizing: border-box; padding: 0px; border-radius: 0px; font-size: 1em; white-space: inherit; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); overflow-wrap: normal;"><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">172.16</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">.253</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">.100</span></code></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">}</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">}</span></div><h3 style="box-sizing: border-box; font-size: 1.5em; margin: 1.5em 0px 0px;"><span style="font-size: 1.5em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.25em; font-weight: 500;">3：重启keepalived服务</span></h3><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">95主机 master：</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">systemctl restart keepalived.service</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">systemctl status keepalived.service</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><img src="keepalived_files/Image [1].png" type="image/png" data-filename="Image.png" alt="clipboard.png" height="196" style="box-sizing:border-box;vertical-align:middle;border:medium none;max-width:100%;padding:3px;position:static;cursor:pointer;display:inline;" title="clipboard.png" width="554"/></span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">ip a：虚拟路由器主机ip已经添加进来</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><img src="keepalived_files/Image [2].png" type="image/png" data-filename="Image.png" alt="clipboard.png" height="133" style="box-sizing:border-box;vertical-align:middle;border:medium none;max-width:100%;padding:3px;position:static;cursor:pointer;display:inline;" title="clipboard.png" width="554"/></span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">tcpdump -nn -i eth0 host 224.24.24.18</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">172.16.253.95 主机通过224.24.24.18向外发送vrrp广播，vrid为1 优先级为100，字节长度为20，简单认证方式，每隔1秒发送一次</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><img src="keepalived_files/Image [3].png" type="image/png" data-filename="Image.png" alt="clipboard.png" height="73" style="box-sizing:border-box;vertical-align:middle;border:medium none;max-width:100%;padding:3px;position:static;cursor:pointer;display:inline;" title="clipboard.png" width="554"/></span></div><div><br style="box-sizing:border-box;"/></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">96主机：backup</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">systemctl restart keepalived.service</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">systemctl status keepalived.service</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><img src="keepalived_files/Image [4].png" type="image/png" data-filename="Image.png" alt="clipboard.png" height="82" style="box-sizing:border-box;vertical-align:middle;border:medium none;max-width:100%;padding:3px;position:static;cursor:pointer;display:inline;" title="clipboard.png" width="554"/></span></div><div><br style="box-sizing:border-box;"/></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">4：模拟vip偏移至 96主机</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">95 主机 stop keepalived服务</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">systemctl stop keepalived.service</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">在96主机上 vip已经偏移至96主机</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><img src="keepalived_files/Image [5].png" type="image/png" data-filename="Image.png" alt="clipboard.png" height="109" style="box-sizing:border-box;vertical-align:middle;border:medium none;max-width:100%;padding:3px;position:static;cursor:pointer;display:inline;" title="clipboard.png" width="554"/></span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">再次在 95 主机重启 keepalived服务 VIP则将重新偏移至95主机</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">默认vrrp工作于抢占 模式。谁的级别高，vip偏移至哪台主机上</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><img src="keepalived_files/Image [6].png" type="image/png" data-filename="Image.png" alt="clipboard.png" height="196" style="box-sizing:border-box;vertical-align:middle;border:medium none;max-width:100%;padding:3px;position:static;cursor:pointer;display:inline;" title="clipboard.png" width="554"/></span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><img src="keepalived_files/Image [7].png" type="image/png" data-filename="Image.png" alt="clipboard.png" height="60" style="box-sizing:border-box;vertical-align:middle;border:medium none;max-width:100%;padding:3px;position:static;cursor:pointer;display:inline;" title="clipboard.png" width="554"/></span></div></div><h2 style="box-sizing: border-box; font-size: 1.75em; margin: 1.5em 0px 0px; border-bottom: 1px solid rgb(238, 238, 238); padding-bottom: 10px;"><span style="font-size: 1.75em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.5em; font-weight: 500;">四: 双主模式</span></h2><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">简述：配置两个虚拟路由器</span></div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">下图为框架：</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><img src="keepalived_files/Image [8].png" type="image/png" data-filename="Image.png" alt="clipboard.png" height="281" style="box-sizing:border-box;vertical-align:middle;border:medium none;max-width:100%;padding:3px;position:static;cursor:pointer;display:inline;" title="clipboard.png" width="554"/></span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">环境：先stop 95 96两台主机的keepalived服务</span></div><h3 style="box-sizing: border-box; font-size: 1.5em; margin: 1.5em 0px 0px;"><span style="font-size: 1.5em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.25em; font-weight: 500;">1：编辑配置文件</span></h3><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">95主机增加如下代码：</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">vrrp_instance VI_2 {</span></div></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">state</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">BACKUP</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">interface eth0</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">virtual_router_id</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">02</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">priority</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">95</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">advert_int</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">1</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">authentication {</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">auth_type PASS</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">auth_pass</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">2222</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">}</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">virtual_ipaddress {</span></div><div><code style="box-sizing: border-box; padding: 0px; border-radius: 0px; font-size: 1em; white-space: inherit; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); overflow-wrap: normal;"><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">172.16</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">.253</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">.200</span></code></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">}</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">}</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">96主机：</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">增加如下代码，相当于增加了另一组虚拟路由器vip2 172.16.253.200</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">vrrp_instance VI_2 {</span></div></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">state</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">MASTER</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">interface eth0</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">virtual_router_id</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">02</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">priority</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">100</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">advert_int</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">1</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">authentication {</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">auth_type PASS</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">auth_pass</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">2222</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">}</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">virtual_ipaddress {</span></div><div><code style="box-sizing: border-box; padding: 0px; border-radius: 0px; font-size: 1em; white-space: inherit; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); overflow-wrap: normal;"><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">172.16</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">.253</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">.200</span></code></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">}</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">}</span></div><h3 style="box-sizing: border-box; font-size: 1.5em; margin: 1.5em 0px 0px;"><span style="font-size: 1.5em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.25em; font-weight: 500;">2：启动96主机服务</span></h3><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 1.5em 0px; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">96</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: initial;">主机：先关闭服务，再启动服务。</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">[root@hkeepalived]#systemctl stop keepalived</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">[root@hkeepalived]#systemctl start keepalived</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">[root@hkeepalived]#systemctl status keepalived</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">两个 vip都添加至 eth0 网卡了</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><img src="keepalived_files/Image [9].png" type="image/png" data-filename="Image.png" alt="clipboard.png" height="223" style="box-sizing:border-box;vertical-align:middle;border:medium none;max-width:100%;padding:3px;position:static;cursor:pointer;display:inline;" title="clipboard.png" width="554"/></span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><img src="keepalived_files/Image [10].png" type="image/png" data-filename="Image.png" alt="clipboard.png" height="193" style="box-sizing:border-box;vertical-align:middle;border:medium none;max-width:100%;padding:3px;position:static;cursor:pointer;display:inline;" title="clipboard.png" width="554"/></span></div></div><h3 style="box-sizing: border-box; font-size: 1.5em; margin: 1.5em 0px 0px;"><span style="font-size: 1.5em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.25em; font-weight: 500;">3：启动95主机服务</span></h3><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">[root@hkeepalived]#systemctl stop keepalived</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">[root@hkeepalived]#systemctl start keepalived</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">[root@hkeepalived]#systemctl status keepalived</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><img src="keepalived_files/Image [11].png" type="image/png" data-filename="Image.png" alt="clipboard.png" height="256" style="box-sizing:border-box;vertical-align:middle;border:medium none;max-width:100%;padding:3px;position:static;cursor:pointer;display:inline;" title="clipboard.png" width="554"/></span></div><div><br style="box-sizing:border-box;"/></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">启动95 主机服务之后 100地址的vip回至95主机。因为172.16.253.100的vip在95主机的优先级要比在96主机上高</span></div></div><h2 style="box-sizing: border-box; font-size: 1.75em; margin: 1.5em 0px 0px; border-bottom: 1px solid rgb(238, 238, 238); padding-bottom: 10px;"><span style="font-size: 1.75em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.5em; font-weight: 500;">五：调用通知机制</span></h2><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">目的:演示通知机制中</span></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">notify_master</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">notify_bacup 是如何工作</span></div></div><h3 style="box-sizing: border-box; font-size: 1.5em; margin: 1.5em 0px 0px;"><span style="font-size: 1.5em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.25em; font-weight: 500;">1：95 96主机</span></h3><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">编辑通知机制的脚本放置在/etc/keepalived下</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">vim notify.sh</span></div></div><h1 style="box-sizing: border-box; font-size: 2em; margin: 1.5em 0px 0px; border-bottom: 1px solid rgb(238, 238, 238); padding-bottom: 10px;"><span style="font-size: 2em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.75em; font-weight: 500;">!/bin/bash</span></h1><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">contact='root@localhost'</span></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="box-sizing:border-box;"><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">notify</span></span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">() {</span></div><div><br/></div><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">local</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">mailsubject=</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">&quot;</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">$(hostname)</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">to be</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">$1</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">, vip floating&quot;</span></div><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">local</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">mailbody=</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">&quot;</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">$(date +'%F %T')</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">: vrrp transition,</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">$(hostname)</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">changed to be</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">$1</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">&quot;</span></div><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">echo</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">&quot;</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">$mailbody</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">&quot;</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">| mail</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">-s</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">&quot;</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">$mailsubject</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">&quot;</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">$contact</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">}</span></div><div><br/></div><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">case</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">$1</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">in</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">master)</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">notify master</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">;;</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">backup)</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">notify backup</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">;;</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">fault)</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">notify fault</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">;;</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">*)</span></div><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">echo</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">&quot;Usage:</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">$(basename $0)</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">{master|backup|fault}&quot;</span></div><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">exit</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">1</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">;;</span></div><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">esac</span></div></div><h3 style="box-sizing: border-box; font-size: 1.5em; margin: 1.5em 0px 0px;"><span style="font-size: 1.5em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.25em; font-weight: 500;">2 :95 96 主机的配置文件恢复至单主模式</span></h3><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">删除 实验四中 增加的配置文件内容</span></div><h3 style="box-sizing: border-box; font-size: 1.5em; margin: 1.5em 0px 0px;"><span style="font-size: 1.5em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.25em; font-weight: 500;">3：编辑配置文件</span></h3><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">95 96 主机中 在vrrp_instance中增加如下代码</span></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">notify_master</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">&quot;/etc/keepalived/notify.sh master&quot;</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">notify_backup</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">&quot;/etc/keepalived/notify.sh backup&quot;</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">notify_fault</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">&quot;/etc/keepalived/notify.sh fault&quot;</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><a href="keepalived_files/squares.svg"><img src="keepalived_files/55a991b20aa0ea2ff6f7138652d8c0a3.png" alt="squares.svg"></a></span></div></div><h3 style="box-sizing: border-box; font-size: 1.5em; margin: 1.5em 0px 0px;"><span style="font-size: 1.5em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.25em; font-weight: 500;">4：启动服务</span></h3><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">启动96主机的服务：</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">查看邮件有无发送：</span></div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">mail</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><a href="keepalived_files/squares.svg"><img src="keepalived_files/55a991b20aa0ea2ff6f7138652d8c0a3.png" alt="squares.svg"></a></span></div><div><br style="box-sizing:border-box;"/></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">启动95主机的服务：</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">96主机将收到 变为 backup 的邮件</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><a href="keepalived_files/squares.svg"><img src="keepalived_files/55a991b20aa0ea2ff6f7138652d8c0a3.png" alt="squares.svg"></a></span></div></div><h2 style="box-sizing: border-box; font-size: 1.75em; margin: 1.5em 0px 0px; border-bottom: 1px solid rgb(238, 238, 238); padding-bottom: 10px;"><span style="font-size: 1.75em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.5em; font-weight: 500;">六：LVS-DR模式--keepalive</span></h2><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">环境：</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">95主机 LVS</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">96主机 LVS</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">97 98 主机RS</span></div></div><h3 style="box-sizing: border-box; font-size: 1.5em; margin: 1.5em 0px 0px;"><span style="font-size: 1.5em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.25em; font-weight: 500;">1:97 98 主机 安装nginx</span></h3><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">yum install nginx –y</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">编辑主页文件：</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">97：vim /usr/share/nginx/html/index.html</span></div></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">&lt;</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">h1</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">&gt;</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: initial;">RS1111111111111</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">&lt;/</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">h1</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">&gt;</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">98：vim /usr/share/nginx/html/index.html</span></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">&lt;</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">h1</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">&gt;</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">RS22222222222</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">&lt;/</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">h1</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); box-sizing: border-box;">&gt;</span></div></div><h3 style="box-sizing: border-box; font-size: 1.5em; margin: 1.5em 0px 0px;"><span style="font-size: 1.5em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.25em; font-weight: 500;">2：后端主机 内核参数修改</span></h3><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">97 98主机编辑脚本</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">1：</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">后端主机内核参数的修改 及 vip的添加</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">编辑脚本，实现对内核参数的修改</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">vim /root/set.sh</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">#!/bin/bash</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">vip=172.16.0.199</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">mask=255.255.255.255</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">iface=&quot;lo:0&quot;</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">case $1 in</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">start)</span></div></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">echo</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">1</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">&gt;</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">/proc/sys</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">/net/ipv</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">4/conf/all/arp_ignore</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">echo</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">2</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">&gt;</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">/proc/sys</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">/net/ipv</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">4/conf/all/arp_announce</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">echo</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">1</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">&gt;</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">/proc/sys</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">/net/ipv</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">4/conf/lo/arp_ignore</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">echo</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">2</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">&gt;</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">/proc/sys</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">/net/ipv</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">4/conf/lo/arp_announce</span></div><div><br/></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">ifconfig</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">$iface</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">$vip</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">netmask</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">$mask</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">broadcast</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">$vip</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">up</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">route add -host</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">$vip</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">dev</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">$iface</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">;;</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">stop)</span></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">ifconfig $iface down</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">echo</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">0</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">&gt;</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">/proc/</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">sys</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">/net/</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">ipv4</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">/conf/</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">all/arp_ignore</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">echo</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">0</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">&gt;</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">/proc/</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">sys</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">/net/</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">ipv4</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">/conf/</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">all/arp_announce</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">echo</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">0</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">&gt;</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">/proc/</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">sys</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">/net/</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">ipv4</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">/conf/</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">lo/arp_ignore</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">echo</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">0</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">&gt;</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">/proc/</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">sys</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">/net/</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">ipv4</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">/conf/</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">lo/arp_announce</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">;;</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">*)</span></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">echo</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">&quot;start|stop&quot;</span></div><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">exit</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">1</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">；；</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">esac</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">2：测试脚本实现</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">bash –x set.sh start</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">ip a</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">查看 lo的ip有无添加进来</span></div></div><h3 style="box-sizing: border-box; font-size: 1.5em; margin: 1.5em 0px 0px;"><span style="font-size: 1.5em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.25em; font-weight: 500;">3：lvs主机95 配置服务</span></h3><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">1 安装ipvsadm</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">2 添加vip至eth0</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">ifconfig eth0:0 172.16.253.199 netmask 255.255.255.255 broadcast 172.16.253.199 up</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">3：配置LVS-NAT 服务</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">[root@h~]#ipvsadm -A -t 172.16.253.199:80 -s rr</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">[root@h~]#ipvsadm -a -t 172.16.253.199:80 -r 172.16.253.97:80 -g</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">[root@h~]#ipvsadm -a -t 172.16.253.199:80 -r 172.16.253.98:80 -g</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">[root@h~]#ipvsadm -L –n</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><img src="keepalived_files/Image [12].png" type="image/png" data-filename="Image.png" alt="clipboard.png" height="117" style="box-sizing:border-box;vertical-align:middle;border:medium none;max-width:100%;padding:3px;position:static;cursor:pointer;display:inline;" title="clipboard.png" width="554"/></span></div><div><br style="box-sizing:border-box;"/></div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">4：测试</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><img src="keepalived_files/Image [13].png" type="image/png" data-filename="Image.png" alt="clipboard.png" height="130" style="box-sizing:border-box;vertical-align:middle;border:medium none;max-width:100%;padding:3px;position:static;cursor:pointer;display:inline;" title="clipboard.png" width="554"/></span></div></div><h3 style="box-sizing: border-box; font-size: 1.5em; margin: 1.5em 0px 0px;"><span style="font-size: 1.5em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.25em; font-weight: 500;">5 down掉 95主机 lvs</span></h3><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">在96主机上部署lvs</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">95主机</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">ipvsadm –C</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">ifdown eth0:0</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">96主机</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">重复步骤3 即可</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">1 安装ipvsadm</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">2 添加vip至eth0</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">ifconfig eth0:0 172.16.253.199 netmask 255.255.255.255 broadcast 172.16.253.199 up</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">3：配置LVS-NAT 服务</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">[root@h~]#ipvsadm -A -t 172.16.253.199:80 -s rr</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">[root@h~]#ipvsadm -a -t 172.16.253.199:80 -r 172.16.253.97:80 -g</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">[root@h~]#ipvsadm -a -t 172.16.253.199:80 -r 172.16.253.98:80 -g</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">[root@h~]#ipvsadm -L –n</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">4 测试 DR模式正常与否</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><a href="keepalived_files/squares.svg"><img src="keepalived_files/55a991b20aa0ea2ff6f7138652d8c0a3.png" alt="squares.svg"></a></span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">5 测试ok后</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">96主机上清空所有规则</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">ipvsadm –C</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">ifconfig eth0:0 down</span></div></div><h3 style="box-sizing: border-box; font-size: 1.5em; margin: 1.5em 0px 0px;"><span style="font-size: 1.5em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.25em; font-weight: 500;">6：实现LVS</span></h3><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">以下代码是 实现 LVS 调度</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">95 96 主机 keepalived.conf配置文件中加入如下代码</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">virtual_server 172.16.253.199 80 {</span></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">delay_loop</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">6</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">lb_algo rr</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">lb_kind DR</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">protocol TCP</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">real_server</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">172.16</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">.253</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">.98</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">80</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">{</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">weight</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">1</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">HTTP_GET {</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">url {</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">path /</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">status_code</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">200</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">}</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">}</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">connect_timeout</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">2</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">nb_get_retry</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">3</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">delay_before_retry</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">1</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">}</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">real_server</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">172.16</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">.253</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">.97</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">80</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">{</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">weight</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">1</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">HTTP_GET {</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">url {</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">path /</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">status_code</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">200</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">}</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">}</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">connect_timeout 2</span></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">nb_get_retry</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">3</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">delay_before_retry</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">1</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">}</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">}</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">重启 keepalived服务</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">测试：</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><img src="keepalived_files/Image [14].png" type="image/png" data-filename="Image.png" alt="clipboard.png" height="223" style="box-sizing:border-box;vertical-align:middle;border:medium none;max-width:100%;padding:3px;position:static;cursor:pointer;display:inline;" title="clipboard.png" width="554"/></span></div></div><h3 style="box-sizing: border-box; font-size: 1.5em; margin: 1.5em 0px 0px;"><span style="font-size: 1.5em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.25em; font-weight: 500;">7 重启 95主机的keepalived服务</span></h3><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">95主机的 优先级比96的高</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">vip会偏移至95主机</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">96主机</span></div><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><img src="keepalived_files/Image [15].png" type="image/png" data-filename="Image.png" alt="clipboard.png" height="214" style="box-sizing:border-box;vertical-align:middle;border:medium none;max-width:100%;padding:3px;position:static;cursor:pointer;display:inline;" title="clipboard.png" width="554"/></span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">95主机</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><img src="keepalived_files/Image [16].png" type="image/png" data-filename="Image.png" alt="clipboard.png" height="222" style="box-sizing:border-box;vertical-align:middle;border:medium none;max-width:100%;padding:3px;position:static;cursor:pointer;display:inline;" title="clipboard.png" width="554"/></span></div></div><h3 style="box-sizing: border-box; font-size: 1.5em; margin: 1.5em 0px 0px;"><span style="font-size: 1.5em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.25em; font-weight: 500;">8检测健康状况功能 有无实现</span></h3><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">给98主机增加iptables规则 ：所有tcp的访问禁止掉</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">iptables –A INPUT –p tcp –dport 80 –j REJECT</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">curl</span> <a href="http://172.16.253.199/" rel="nofollow noreferrer" style="box-sizing: border-box; background: none 0% 0% repeat scroll transparent; outline: currentcolor none 0px; border-bottom: 1px solid rgba(0, 154, 97, 0.25); padding-bottom: 1px; font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; line-height: 1.8; color: rgb(0, 154, 97); text-decoration: none;" target="_blank">http://172.16.253.199</a> <span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">访问就会仅仅访问 97主机了</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><img src="keepalived_files/Image [17].png" type="image/png" data-filename="Image.png" alt="clipboard.png" height="169" style="box-sizing:border-box;vertical-align:middle;border:medium none;max-width:100%;padding:3px;position:static;cursor:pointer;display:inline;" title="clipboard.png" width="554"/></span></div></div><h3 style="box-sizing: border-box; font-size: 1.5em; margin: 1.5em 0px 0px;"><span style="font-size: 1.5em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.25em; font-weight: 500;">9：增加sorry server</span></h3><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">在 95 96主机上增加soory server 内容</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">当 后端 9798主机的全部宕机之后。95 96提供sorry server页面服务</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">95 96主机</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">1：安装nginx 提供sorry页面</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">vim /usr/share/nginx/html/index.html</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">2:更改配置文件 keepalived.conf</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">在 virtual_server中</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">增加一行代码 sorry_server 127.0.0.1 80</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><a href="keepalived_files/squares.svg"><img src="keepalived_files/55a991b20aa0ea2ff6f7138652d8c0a3.png" alt="squares.svg"></a></span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">重启keepalived服务</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">[root@hkeepalived]#systemctl stop keepalived</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">[root@hkeepalived]#systemctl start keepalived</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">down掉 后端主机 9798 nginx服务</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">测试访问：</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">curl</span> <a href="http://172.16.253.199/" rel="nofollow noreferrer" style="box-sizing: border-box; background: none 0% 0% repeat scroll transparent; outline: currentcolor none 0px; border-bottom: 1px solid rgba(0, 154, 97, 0.25); padding-bottom: 1px; font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; line-height: 1.8; color: rgb(0, 154, 97); text-decoration: none;" target="_blank">http://172.16.253.199</a> <span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">访问的是95 主机上的 sorry页面</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><a href="keepalived_files/squares.svg"><img src="keepalived_files/55a991b20aa0ea2ff6f7138652d8c0a3.png" alt="squares.svg"></a></span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">关闭 95主机的keepalived 服务</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">测试访问：</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">curl</span> <a href="http://172.16.253.199/" rel="nofollow noreferrer" style="box-sizing: border-box; background: none 0% 0% repeat scroll transparent; outline: currentcolor none 0px; border-bottom: 1px solid rgba(0, 154, 97, 0.25); padding-bottom: 1px; font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; line-height: 1.8; color: rgb(0, 154, 97); text-decoration: none;" target="_blank">http://172.16.253.199</a> <span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">访问的是96 主机上的 sorry页面</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><a href="keepalived_files/squares.svg"><img src="keepalived_files/55a991b20aa0ea2ff6f7138652d8c0a3.png" alt="squares.svg"></a></span></div></div><h1 style="box-sizing: border-box; font-size: 2em; margin: 1.5em 0px 0px; border-bottom: 1px solid rgb(238, 238, 238); padding-bottom: 10px;"><span style="font-size: 2em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.75em; font-weight: 500;">三：高可用服务</span></h1><h2 style="box-sizing: border-box; font-size: 1.75em; margin: 1.5em 0px 0px; border-bottom: 1px solid rgb(238, 238, 238); padding-bottom: 10px;"><span style="font-size: 1.75em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.5em; font-weight: 500;">一：理论描述</span></h2><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">目的：</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">借助脚本实现 高可用服务(ninx/http/haproxy)</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">也就是说在服务不可用时，vip偏移至备用节点。而不是之前实现的主机down掉之后vip偏移至备用节点。</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">环境：</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">95 96主机。keepalived 服务stop</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">脚本例子：</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">1：rpm –ql keepalived</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">此文件内有脚本的例子，以及如何调用</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">/usr/share/doc/keepalived-1.2.13/samples/keepalived.conf.vrrp.localcheck</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><img src="keepalived_files/Image [18].png" type="image/png" data-filename="Image.png" alt="clipboard.png" height="21" style="box-sizing:border-box;vertical-align:middle;border:medium none;max-width:100%;padding:3px;position:static;cursor:pointer;display:inline;" title="clipboard.png" width="554"/></span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">2：cat /usr/share/doc/keepalived-1.2.13/samples/keepalived.conf.vrrp.localcheck</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><img src="keepalived_files/Image [19].png" type="image/png" data-filename="Image.png" alt="clipboard.png" height="214" style="box-sizing:border-box;vertical-align:middle;border:medium none;max-width:100%;padding:3px;position:static;cursor:pointer;display:inline;" title="clipboard.png" width="554"/></span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">3：脚本简述</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">1:在配置文件中定义脚本</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">vrrp_script chk_sshd {</span></div></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">script &quot;killall -0 sshd&quot;</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); font-style: normal;"># cheaper than pidof</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">interval</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">2</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); font-style: normal;"># check every 2 seconds</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">weight -4</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); font-style: normal;"># default prio: -4 if KO</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">fall</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">2</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); font-style: normal;"># require 2 failures for KO</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">rise</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">2</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0); font-style: normal;"># require 2 successes for OK</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">}</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">调用脚本 使用 vrrp_script 关键词</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">脚本名 chk_sshd</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">脚本内容分为两块</span></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">1</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">script</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">&quot;killall -0 sshd&quot;</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">表示 此段代码 返回</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">0</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">值，部分功能不变</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">返回非</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">0</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">值。要执行一些关键指令</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">killall -0 sshd ：测试 是否可以杀掉 sshd进程。能杀掉返回0值，表示sshd服务</span></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: initial;">正常运行。返回其他值，表示sshd服务没有运行正常。</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">2：weight -4 测试失败权重-4</span></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">fall</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">2</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">检测失败</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">2</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">次，才减去权重</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">rise</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">-2</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">检查两次成功，ok</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">2：在配置文件中调用脚本</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">在 vrrp_instance中</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">使用track_script {</span></div></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">chk_haproxy weight</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">2</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">chk_http_</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">port</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">chk_https_port</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">chk_smtp_port</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">}</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">此种模式调用脚本</span></div><h2 style="box-sizing: border-box; font-size: 1.75em; margin: 1.5em 0px 0px; border-bottom: 1px solid rgb(238, 238, 238); padding-bottom: 10px;"><span style="font-size: 1.75em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.5em; font-weight: 500;">二：nginx 服务 高可用</span></h2><h3 style="box-sizing: border-box; font-size: 1.5em; margin: 1.5em 0px 0px;"><span style="font-size: 1.5em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.25em; font-weight: 500;">1：先定义脚本，再调用脚本</span></h3><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">95 96主机同时更改配置文件</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">编辑keepalived.conf文件</span></div></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">1</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">）增加脚本</span></div><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">2</span><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">）调用脚本</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">1)编辑脚本</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">vim /etc/keepalived.conf</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">vrrp_script chk_nginx{</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">script &quot;[[ -f /etc/keepalived/down ]] &amp;&amp; exit 1 ||exit 0 &quot;</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">interval 1</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">weight -10</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">fall 2</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">rise 1</span></div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">}</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">script &quot;[[ -f /etc/keepalived/down ]] &amp;&amp; echo 1 ||echo 0 &quot;</span></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">down文件存在 返回</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">1</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">down文件不存在 返回</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">0</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">依靠down文件存在与否 来降低/保持 主节点的权重</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">2）调用脚本</span></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">track_script</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">{</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">chk_nginx</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">}</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">使用 track_script 关键词 调用脚本</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><img src="keepalived_files/Image [20].png" type="image/png" data-filename="Image.png" alt="clipboard.png" height="390" style="box-sizing:border-box;vertical-align:middle;border:medium none;max-width:100%;padding:3px;position:static;cursor:pointer;display:inline;" title="clipboard.png" width="554"/></span></div></div><h3 style="box-sizing: border-box; font-size: 1.5em; margin: 1.5em 0px 0px;"><span style="font-size: 1.5em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.25em; font-weight: 500;">2：测试</span></h3><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">在95主机上 touch /etc/keepalived/down文件</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">vip偏移至96主机</span></div></div><h3 style="box-sizing: border-box; font-size: 1.5em; margin: 1.5em 0px 0px;"><span style="font-size: 1.5em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.25em; font-weight: 500;">3：编辑 nginx配置文件</span></h3><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">95 96主机</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">vim /etc/nginx/nginx.conf</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">server 中增加</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">location / {</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">proxy_pass</span> <a href="http://websrvs;/" rel="nofollow noreferrer" style="box-sizing: border-box; background: none 0% 0% repeat scroll transparent; outline: currentcolor none 0px; border-bottom: 1px solid rgba(0, 154, 97, 0.25); padding-bottom: 1px; font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; line-height: 1.8; color: rgb(0, 154, 97); text-decoration: none;" target="_blank">http://websrvs;</a></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">}</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">server上增加</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">upstream websrvs {</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">server 172.16.253.97:80;</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">server 172.16.253.98:80;</span></div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">}</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">此段主要实现 nginx的 服务调度至后端服务器</span></div><h3 style="box-sizing: border-box; font-size: 1.5em; margin: 1.5em 0px 0px;"><span style="font-size: 1.5em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.25em; font-weight: 500;">4：测试web主页访问</span></h3><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><img src="keepalived_files/Image [21].png" type="image/png" data-filename="Image.png" alt="clipboard.png" height="124" style="box-sizing:border-box;vertical-align:middle;border:medium none;max-width:100%;padding:3px;position:static;cursor:pointer;display:inline;" title="clipboard.png" width="554"/></span></div></div><h2 style="box-sizing: border-box; font-size: 1.75em; margin: 1.5em 0px 0px; border-bottom: 1px solid rgb(238, 238, 238); padding-bottom: 10px;"><span style="font-size: 1.75em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.5em; font-weight: 500;">三：双主模型nginx 高可用集群</span></h2><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">上接实验三：</span></div><h3 style="box-sizing: border-box; font-size: 1.5em; margin: 1.5em 0px 0px;"><span style="font-size: 1.5em; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.25em; font-weight: 500;">1：编辑配置文件</span></h3><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">增加 vrrp_instance 实例2</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">96主机 在vip2上为MASTER</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">95主机在 vip2上为BACKUP</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">96主机增加如下内容：</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">vrrp_instance VI_2 {</span></div></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">state</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">MASTER</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">interface eth0</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">virtual_router_id</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">61</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">priority</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">100</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">advert_int</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">1</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">authentication {</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">auth_type PASS</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">auth_pass</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">1111</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">}</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">virtual_ipaddress {</span></div><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">172.16</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">.253</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">.188</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">}</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">track_script {</span></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: initial;">chk_nginx</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">}</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">}</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><img src="keepalived_files/Image [22].png" type="image/png" data-filename="Image.png" alt="clipboard.png" height="485" style="box-sizing:border-box;vertical-align:middle;border:medium none;max-width:100%;padding:3px;position:static;cursor:pointer;display:inline;" title="clipboard.png" width="548"/></span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">95主机增加如下内容：</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">vrrp_instance VI_2 {</span></div></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">state</span> <span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">BACKUP</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">interface eth0</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">virtual_router_id</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">61</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">priority</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">95</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">advert_int</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">1</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">authentication {</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">auth_type PASS</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">auth_pass</span> <span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">1111</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">}</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">virtual_ipaddress {</span></div><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">172.16</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">.253</span><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">.188</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">}</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">track_script {</span></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="box-sizing: border-box; font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background-color: rgba(0, 0, 0, 0);">chk_nginx</span></div><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">chk_nn</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><img src="keepalived_files/Image [23].png" type="image/png" data-filename="Image.png" alt="clipboard.png" height="419" style="box-sizing:border-box;vertical-align:middle;border:medium none;max-width:100%;padding:3px;position:static;cursor:pointer;display:inline;" title="clipboard.png" width="554"/></span></div></div><div style="box-sizing: border-box; word-break: break-all; overflow-wrap: break-word; border-radius: 4px; overflow: auto; font-size: 0.93em; padding: 1em; margin: 0px 0px 1.5em; background: url(&quot;https://static.segmentfault.com/v-5b7544bd/global/css/../img/blueprint.png&quot;) 0% 0% / 30px repeat scroll padding-box border-box rgb(246, 246, 246), 0% 0% / 30px; border: medium none; max-height: 35em; position: relative;"><div><span style="font-size: 1em; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; color: rgb(51, 51, 51); line-height: 1.45; background: none 0% 0% repeat scroll rgba(0, 0, 0, 0); border-radius: 0px; box-sizing: border-box; overflow-wrap: normal; padding: 0px; white-space: inherit;">}</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">### 2: 测试双主模式</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">95主机 关闭—启动服务</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">96主机关闭服务</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">1）vip1 及vip2 都在 95主机上</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><img src="keepalived_files/Image [24].png" type="image/png" data-filename="Image.png" alt="clipboard.png" height="257" style="box-sizing:border-box;vertical-align:middle;border:medium none;max-width:100%;padding:3px;position:static;cursor:pointer;display:inline;" title="clipboard.png" width="554"/></span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">2）启动96 主机上的keepalived 服务</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">vip2 跳转至 96主机上</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><img src="keepalived_files/Image [25].png" type="image/png" data-filename="Image.png" alt="clipboard.png" height="121" style="box-sizing:border-box;vertical-align:middle;border:medium none;max-width:100%;padding:3px;position:static;cursor:pointer;display:inline;" title="clipboard.png" width="554"/></span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">3） 在95 主机上 建 /etc/keepalived/down文件</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">vip1 199也跳转至 96主机上</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><img src="keepalived_files/Image [26].png" type="image/png" data-filename="Image.png" alt="clipboard.png" height="339" style="box-sizing:border-box;vertical-align:middle;border:medium none;max-width:100%;padding:3px;position:static;cursor:pointer;display:inline;" title="clipboard.png" width="418"/></span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">4） 客户端测试访问</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><img src="keepalived_files/Image [27].png" type="image/png" data-filename="Image.png" alt="clipboard.png" height="308" style="box-sizing:border-box;vertical-align:middle;border:medium none;max-width:100%;padding:3px;position:static;cursor:pointer;display:inline;" title="clipboard.png" width="554"/></span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">3：改变 nginx的调度算法</span></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><img src="keepalived_files/Image [28].png" type="image/png" data-filename="Image.png" alt="clipboard.png" height="212" style="box-sizing:border-box;vertical-align:middle;border:medium none;max-width:100%;padding:3px;position:static;cursor:pointer;display:inline;" title="clipboard.png" width="554"/></span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">2 hash算法</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">hash $request_uri consistent</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">hash $remote_addr</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">hash $cookie_name</span></div><div><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">ip_hash 改为 hash $request_uri consistent</span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px;"><div style="box-sizing: border-box; text-align: center;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;"><img src="keepalived_files/Image [29].png" type="image/png" data-filename="Image.png" alt="clipboard.png" height="121" style="box-sizing:border-box;vertical-align:middle;border:medium none;max-width:100%;padding:3px;position:static;cursor:pointer;display:inline;" title="clipboard.png" width="554"/></span></div></div><div style="box-sizing: border-box; margin: 1.5em 0px 0px;"><span style="font-size: 15px; font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; color: rgb(51, 51, 51); line-height: 1.8;">}</span></div></div><div style="box-sizing:border-box;"><div style="box-sizing:border-box;background:rgb(255, 255, 255) none repeat scroll 0% 0%;border-color:rgba(0, 0, 0, 0.09) currentcolor currentcolor;border-style:solid none none;border-width:1px 0px 0px;border-image:none 100% / 1 / 0 stretch;box-shadow:none;"><div style="box-sizing:border-box;background:rgb(250, 250, 250) none repeat scroll 0% 0%;box-shadow:rgba(0, 0, 0, 0.09) 0px 1px 0px 0px;border-radius:2px 2px 0px 0px;padding:15px 20px;border-top:1px solid rgba(0, 0, 0, 0.09);margin-top:-1px;"><br/></div></div></div></div></div></div></div></div></div></div><div><br/></div></span>
</div></body></html> 