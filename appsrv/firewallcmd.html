<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307027 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="3008"/>

<div><span>
  <div>
<div style="font-size: 16px; display: inline-block; min-width: 100%;position: relative;"><div style="box-sizing:border-box;font-family:sans-serif;text-size-adjust:100%;font-size:10px;-webkit-tap-highlight-color:transparent;"><div style="box-sizing:border-box;font-size:17px;line-height:1.42857;background-color:rgb(255, 255, 255);min-width:768px;color:rgb(51, 51, 51);font-family:-apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;"><div style="box-sizing:border-box;"><div style="box-sizing:border-box;"><div style="box-sizing:border-box;">
        <h1 style="box-sizing:border-box;color:inherit;margin-top:20px;margin-bottom:10px;font-size:34px;margin:20px 0px 0px;font-family:-apple-system, &quot;SF UI Display&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-weight:700;line-height:1.3;word-break:break-word;">CentOS 7 中firewall-cmd命令 </h1>

        
        <div style="box-sizing:border-box;margin:30px 0px 40px;">
          <a href="https://www.jianshu.com/u/c957e098171d" style="box-sizing:border-box;background-color:transparent;color:rgb(51, 51, 51);text-decoration:none;cursor:pointer;width:48px;height:48px;display:inline-block;vertical-align:middle;">
            <img src="firewallcmd_files/96" type="image/jpeg" data-filename="96" height="46" style="box-sizing:border-box;vertical-align:middle;border:1px solid rgb(221, 221, 221);width:100%;height:100%;border-radius:50%;" width="46"/>
</a>          <div style="box-sizing:border-box;vertical-align:middle;display:inline-block;margin-left:8px;">
            <span style="box-sizing:border-box;margin-right:3px;font-size:16px;vertical-align:middle;"><a href="https://www.jianshu.com/u/c957e098171d" style="box-sizing:border-box;background-color:transparent;color:rgb(51, 51, 51);text-decoration:none;cursor:pointer;">小慕先森</a></span>
            
            <a style="cursor:pointer;background-color:rgb(66, 192, 46);color:rgb(255, 255, 255);text-decoration:none;display:inline-block;margin-bottom:0px;font-weight:400;text-align:center;vertical-align:middle;touch-action:manipulation;box-sizing:border-box;background-image:none;border:1px solid transparent;white-space:nowrap;user-select:none;border-radius:40px;line-height:normal;border-color:rgb(66, 192, 46);font-size:12px;padding:0px 7px 0px 5px;"><i style="box-sizing:border-box;font-size:inherit;font-style:normal;-webkit-font-smoothing:antialiased;font-family:iconfont;font-weight:400;"><span style="font-size:inherit;font-style:normal;font-family:iconfont;font-weight:400;"></span></i><span style="box-sizing:border-box;margin-left:2px;display:inline;">关注</span></a>
            
            <div style="box-sizing:border-box;margin-top:5px;font-size:12px;color:rgb(150, 150, 150);">
              
                <span style="box-sizing:border-box;padding-right:5px;" title="">2017.08.14 10:48*</span>
              <span style="box-sizing:border-box;padding-right:5px;">字数 248</span>
            <span style="box-sizing:border-box;padding-right:5px;">阅读 10568</span><span style="box-sizing:border-box;padding-right:5px;">评论 0</span><span style="box-sizing:border-box;padding-right:5px;">喜欢 4</span></div>
          </div>
          
        </div>


        
        <div style="box-sizing:border-box;color:rgb(47, 47, 47);font-size:16px;font-weight:400;line-height:1.7;word-break:break-word;">
          <div style="box-sizing:border-box;">
            <p style="box-sizing:border-box;margin:0px 0px 25px;word-break:break-word;">如果你的系统上没有安装使用命令安装<br style="box-sizing:border-box;"/>
安装firewalld 防火墙<code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:rgb(199, 37, 78);border-radius:4px;font-size:12px;background-color:rgb(246, 246, 246);padding:2px 4px;border:none;white-space:pre-wrap;vertical-align:middle;">yum install firewalld</code></p>
<p style="box-sizing:border-box;margin:0px 0px 25px;word-break:break-word;">开启服务<code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:rgb(199, 37, 78);border-radius:4px;font-size:12px;background-color:rgb(246, 246, 246);padding:2px 4px;border:none;white-space:pre-wrap;vertical-align:middle;">systemctl start firewalld.service</code></p>
<p style="box-sizing:border-box;margin:0px 0px 25px;word-break:break-word;">关闭防火墙<code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:rgb(199, 37, 78);border-radius:4px;font-size:12px;background-color:rgb(246, 246, 246);padding:2px 4px;border:none;white-space:pre-wrap;vertical-align:middle;">systemctl stop firewalld.service</code></p>
<p style="box-sizing:border-box;margin:0px 0px 25px;word-break:break-word;">开机自动启动<code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:rgb(199, 37, 78);border-radius:4px;font-size:12px;background-color:rgb(246, 246, 246);padding:2px 4px;border:none;white-space:pre-wrap;vertical-align:middle;">systemctl enable firewalld.service</code></p>
<p style="box-sizing:border-box;margin:0px 0px 25px;word-break:break-word;">关闭开机制动启动<code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:rgb(199, 37, 78);border-radius:4px;font-size:12px;background-color:rgb(246, 246, 246);padding:2px 4px;border:none;white-space:pre-wrap;vertical-align:middle;">systemctl disable firewalld.service</code></p>
<h2 style="box-sizing:border-box;font-family:inherit;margin-top:20px;margin-bottom:10px;font-weight:700;line-height:1.7;color:rgb(47, 47, 47);font-size:24px;margin:0px 0px 15px;text-rendering:optimizeLegibility;">使用firewall-cmd 命令</h2>
<p style="box-sizing:border-box;margin:0px 0px 25px;word-break:break-word;">查看状态<code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:rgb(199, 37, 78);border-radius:4px;font-size:12px;background-color:rgb(246, 246, 246);padding:2px 4px;border:none;white-space:pre-wrap;vertical-align:middle;">firewall-cmd --state</code> //running 表示运行</p>
<p style="box-sizing:border-box;margin:0px 0px 25px;word-break:break-word;">获取活动的区域<code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:rgb(199, 37, 78);border-radius:4px;font-size:12px;background-color:rgb(246, 246, 246);padding:2px 4px;border:none;white-space:pre-wrap;vertical-align:middle;">firewall-cmd --get-active-zones</code><br style="box-sizing:border-box;"/>
这条命令将用以下格式输出每个区域所含接口：<br style="box-sizing:border-box;"/>
&lt;zone1&gt;: &lt;interface1&gt; &lt;interface2&gt; ..&lt;zone2&gt;: &lt;interface3&gt; ..</p>
<p style="box-sizing:border-box;margin:0px 0px 25px;word-break:break-word;">获取所有支持的服务<code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:rgb(199, 37, 78);border-radius:4px;font-size:12px;background-color:rgb(246, 246, 246);padding:2px 4px;border:none;white-space:pre-wrap;vertical-align:middle;">firewall-cmd --get-service</code><br style="box-sizing:border-box;"/>
在不改变状态的条件下重新加载防火墙：<code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:rgb(199, 37, 78);border-radius:4px;font-size:12px;background-color:rgb(246, 246, 246);padding:2px 4px;border:none;white-space:pre-wrap;vertical-align:middle;">firewall-cmd --reload</code><br style="box-sizing:border-box;"/>
启用某个服务</p>
<pre style="word-wrap:normal;background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.42857;margin:0px 0px 10px;border-radius:4px;padding:15px;display:block;color:rgb(171, 178, 191);font-size:13px;background:rgb(40, 44, 52);margin-bottom:20px;white-space:pre;overflow-x:auto;overflow:auto;word-break:break-word;"><code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:inherit;border-radius:0px;font-size:12px;border:none;vertical-align:middle;background-color:transparent;padding:0px;white-space:pre;"> firewall-cmd --zone=<span style="box-sizing:border-box;color:rgb(198, 120, 221);">public</span> --add-service=https <span style="box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;">//临时</span>

firewall-cmd --permanent --zone=<span style="box-sizing:border-box;color:rgb(198, 120, 221);">public</span> --add-service=https <span style="box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;">//永久</span>
</code></pre>
<p style="box-sizing:border-box;margin:0px 0px 25px;word-break:break-word;">开启某个端口</p>
<pre style="word-wrap:normal;background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.42857;margin:0px 0px 10px;border-radius:4px;padding:15px;display:block;color:rgb(171, 178, 191);font-size:13px;background:rgb(40, 44, 52);margin-bottom:20px;white-space:pre;overflow-x:auto;overflow:auto;word-break:break-word;"><code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:inherit;border-radius:0px;font-size:12px;border:none;vertical-align:middle;background-color:transparent;padding:0px;white-space:pre;">firewall-cmd --permanent --zone=<span style="box-sizing:border-box;color:rgb(198, 120, 221);">public</span> --add-port=<span style="box-sizing:border-box;color:rgb(209, 154, 102);">8080</span><span style="box-sizing:border-box;color:rgb(209, 154, 102);">-8081</span>/tcp <span style="box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;">//永久</span>

firewall-cmd --zone=<span style="box-sizing:border-box;color:rgb(198, 120, 221);">public</span> --add-port=<span style="box-sizing:border-box;color:rgb(209, 154, 102);">8080</span><span style="box-sizing:border-box;color:rgb(209, 154, 102);">-8081</span>/tcp <span style="box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;">//临时</span>
</code></pre>
<p style="box-sizing:border-box;margin:0px 0px 25px;word-break:break-word;">使用命令加载设置<code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:rgb(199, 37, 78);border-radius:4px;font-size:12px;background-color:rgb(246, 246, 246);padding:2px 4px;border:none;white-space:pre-wrap;vertical-align:middle;">firewall-cmd --reload</code></p>
<p style="box-sizing:border-box;margin:0px 0px 25px;word-break:break-word;">查看开启的端口和服务</p>
<pre style="word-wrap:normal;background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.42857;margin:0px 0px 10px;border-radius:4px;padding:15px;display:block;color:rgb(171, 178, 191);font-size:13px;background:rgb(40, 44, 52);margin-bottom:20px;white-space:pre;overflow-x:auto;overflow:auto;word-break:break-word;"><code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:inherit;border-radius:0px;font-size:12px;border:none;vertical-align:middle;background-color:transparent;padding:0px;white-space:pre;">firewall-cmd --permanent --zone=<span style="box-sizing:border-box;color:rgb(198, 120, 221);">public</span> --<span style="box-sizing:border-box;color:rgb(230, 192, 123);">list</span>-services <span style="box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;">//服务空格隔开 例如 dhcpv6-client https ss</span>

firewall-cmd --permanent --zone=<span style="box-sizing:border-box;color:rgb(198, 120, 221);">public</span> --<span style="box-sizing:border-box;color:rgb(230, 192, 123);">list</span>-ports <span style="box-sizing:border-box;color:rgb(92, 99, 112);font-style:italic;">//端口空格隔开 例如 8080-8081/tcp 8388/tcp 80/tcp</span>
</code></pre>
<p style="box-sizing:border-box;margin:0px 0px 25px;word-break:break-word;">设置某个ip 访问某个服务</p>
<pre style="word-wrap:normal;background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.42857;margin:0px 0px 10px;border-radius:4px;padding:15px;display:block;color:rgb(171, 178, 191);font-size:13px;background:rgb(40, 44, 52);margin-bottom:20px;white-space:pre;overflow-x:auto;overflow:auto;word-break:break-word;"><code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:inherit;border-radius:0px;font-size:12px;border:none;vertical-align:middle;background-color:transparent;padding:0px;white-space:pre;">firewall-cmd --permanent --zone=<span style="box-sizing:border-box;color:rgb(198, 120, 221);">public</span> --add-rich-rule=<span style="box-sizing:border-box;color:rgb(152, 195, 121);">&quot;rule family=&quot;</span>ipv4<span style="box-sizing:border-box;color:rgb(152, 195, 121);">&quot; source address=&quot;</span><span style="box-sizing:border-box;color:rgb(209, 154, 102);">192.168</span><span style="box-sizing:border-box;color:rgb(209, 154, 102);">.0</span><span style="box-sizing:border-box;color:rgb(209, 154, 102);">.4</span>/<span style="box-sizing:border-box;color:rgb(209, 154, 102);">24</span><span style="box-sizing:border-box;color:rgb(152, 195, 121);">&quot; service name=&quot;</span>http<span style="box-sizing:border-box;color:rgb(152, 195, 121);">&quot; accept&quot;</span>

ip <span style="box-sizing:border-box;color:rgb(209, 154, 102);">192.168</span><span style="box-sizing:border-box;color:rgb(209, 154, 102);">.0</span><span style="box-sizing:border-box;color:rgb(209, 154, 102);">.4</span>/<span style="box-sizing:border-box;color:rgb(209, 154, 102);">24</span> 访问 http
</code></pre>
<p style="box-sizing:border-box;margin:0px 0px 25px;word-break:break-word;">删除上面设置的规则</p>
<pre style="word-wrap:normal;background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.42857;margin:0px 0px 10px;border-radius:4px;padding:15px;display:block;color:rgb(171, 178, 191);font-size:13px;background:rgb(40, 44, 52);margin-bottom:20px;white-space:pre;overflow-x:auto;overflow:auto;word-break:break-word;"><code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:inherit;border-radius:0px;font-size:12px;border:none;vertical-align:middle;background-color:transparent;padding:0px;white-space:pre;">firewall-cmd --permanent --zone=<span style="box-sizing:border-box;color:rgb(198, 120, 221);">public</span> --remove-rich-rule=<span style="box-sizing:border-box;color:rgb(152, 195, 121);">&quot;rule family=&quot;</span>ipv4<span style="box-sizing:border-box;color:rgb(152, 195, 121);">&quot; source address=&quot;</span><span style="box-sizing:border-box;color:rgb(209, 154, 102);">192.168</span><span style="box-sizing:border-box;color:rgb(209, 154, 102);">.0</span><span style="box-sizing:border-box;color:rgb(209, 154, 102);">.4</span>/<span style="box-sizing:border-box;color:rgb(209, 154, 102);">24</span><span style="box-sizing:border-box;color:rgb(152, 195, 121);">&quot; service name=&quot;</span>http<span style="box-sizing:border-box;color:rgb(152, 195, 121);">&quot; accept&quot;</span>
</code></pre>
<p style="box-sizing:border-box;margin:0px 0px 25px;word-break:break-word;">检查设定是否生效</p>
<pre style="word-wrap:normal;background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.42857;margin:0px 0px 10px;border-radius:4px;padding:15px;display:block;color:rgb(171, 178, 191);font-size:13px;background:rgb(40, 44, 52);margin-bottom:20px;white-space:pre;overflow-x:auto;overflow:auto;word-break:break-word;"><code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:inherit;border-radius:0px;font-size:12px;border:none;vertical-align:middle;background-color:transparent;padding:0px;white-space:pre;"> iptables -L -n | grep <span style="box-sizing:border-box;color:rgb(209, 154, 102);">21</span>
ACCEPT     tcp  --  <span style="box-sizing:border-box;color:rgb(209, 154, 102);">0.0</span><span style="box-sizing:border-box;color:rgb(209, 154, 102);">.0</span><span style="box-sizing:border-box;color:rgb(209, 154, 102);">.0</span>/<span style="box-sizing:border-box;color:rgb(209, 154, 102);">0</span>            <span style="box-sizing:border-box;color:rgb(209, 154, 102);">0.0</span><span style="box-sizing:border-box;color:rgb(209, 154, 102);">.0</span><span style="box-sizing:border-box;color:rgb(209, 154, 102);">.0</span>/<span style="box-sizing:border-box;color:rgb(209, 154, 102);">0</span>            tcp dpt:<span style="box-sizing:border-box;color:rgb(209, 154, 102);">21</span> ctstate <span style="box-sizing:border-box;color:rgb(198, 120, 221);">NEW</span>
</code></pre>
<p style="box-sizing:border-box;margin:0px 0px 25px;word-break:break-word;">执行命令<code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:rgb(199, 37, 78);border-radius:4px;font-size:12px;background-color:rgb(246, 246, 246);padding:2px 4px;border:none;white-space:pre-wrap;vertical-align:middle;">firewall-cmd --list-all</code><br style="box-sizing:border-box;"/>
显示：</p>
<pre style="word-wrap:normal;background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.42857;margin:0px 0px 10px;border-radius:4px;padding:15px;display:block;color:rgb(171, 178, 191);font-size:13px;background:rgb(40, 44, 52);margin-bottom:20px;white-space:pre;overflow-x:auto;overflow:auto;word-break:break-word;"><code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:inherit;border-radius:0px;font-size:12px;border:none;vertical-align:middle;background-color:transparent;padding:0px;white-space:pre;"><span style="box-sizing:border-box;color:rgb(198, 120, 221);">public</span> (<span style="box-sizing:border-box;color:rgb(198, 120, 221);">default</span>)
  interfaces:
  sources:
  services: dhcpv6-client ftp ssh
  ports:
  masquerade: no
  forward-ports:
  icmp-blocks:
  rich rules:
</code></pre>
<p style="box-sizing:border-box;margin:0px 0px 25px;word-break:break-word;">查询服务的启动状态</p>
<pre style="word-wrap:normal;background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.42857;margin:0px 0px 10px;border-radius:4px;padding:15px;display:block;color:rgb(171, 178, 191);font-size:13px;background:rgb(40, 44, 52);margin-bottom:20px;white-space:pre;overflow-x:auto;overflow:auto;word-break:break-word;"><code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:inherit;border-radius:0px;font-size:12px;border:none;vertical-align:middle;background-color:transparent;padding:0px;white-space:pre;">firewall-cmd --query-service ftp
yes
firewall-cmd --query-service ssh
yes
firewall-cmd --query-service samba
no
firewall-cmd --query-service http
no
</code></pre>
<p style="box-sizing:border-box;margin:0px 0px 25px;word-break:break-word;">自行加入要开放的 Port</p>
<pre style="word-wrap:normal;background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;line-height:1.42857;margin:0px 0px 10px;border-radius:4px;padding:15px;display:block;color:rgb(171, 178, 191);font-size:13px;background:rgb(40, 44, 52);margin-bottom:20px;white-space:pre;overflow-x:auto;overflow:auto;word-break:break-word;"><code style="box-sizing:border-box;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:inherit;border-radius:0px;font-size:12px;border:none;vertical-align:middle;background-color:transparent;padding:0px;white-space:pre;">firewall-cmd --add-port=<span style="box-sizing:border-box;color:rgb(209, 154, 102);">3128</span>/tcp
firewall-cmd --<span style="box-sizing:border-box;color:rgb(230, 192, 123);">list</span>-all
<span style="box-sizing:border-box;color:rgb(198, 120, 221);">public</span> (<span style="box-sizing:border-box;color:rgb(198, 120, 221);">default</span>)
  interfaces:
  sources:
  services: dhcpv6-client ftp ssh
  ports: <span style="box-sizing:border-box;color:rgb(209, 154, 102);">3128</span>/tcp
  masquerade: no
  forward-ports:
  icmp-blocks:
  rich rules:
</code></pre>

          </div>
        </div>
    </div></div></div></div></div></div>
</div>
</span>
</div></body></html> 