<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307027 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="3006"/>

<div><span>
  <div>
<div style="font-size: 16px; display: inline-block; min-width: 100%;position: relative;"><div><div style="font-family:&quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;color:rgb(0, 0, 0);background:url(/Skins/coffee/images/bg_body.gif) left top;line-height:1.5;font-size:14px;"><div style="min-width:auto;"><div style="min-width:auto;text-align:left;"><div style="background:transparent;text-align:left;overflow-x:hidden;"><div style="background:url(/Skins/coffee/images/bg_left.gif) left top repeat-x rgb(254, 254, 242);"><div><div style="text-overflow:ellipsis;overflow:hidden;word-break:break-all;"><div>
		<h1 style="margin:0px;padding:0px;width:100%;clear:both;font-weight:bold;float:left;line-height:1.5;font-size:14px;padding-left:5px;">
			<a href="https://www.cnblogs.com/bill1015/p/6847841.html" style="margin:0px;padding:0px;text-decoration:none;color:rgb(7, 93, 179);">25个iptables常用示例</a>
		</h1>
		<div style="margin:0px;padding:0px;clear:both;"></div>
		<div style="margin:0px;padding:5px 2px 5px 5px;line-height:1.5;color:rgb(0, 0, 0);font-size:13px;margin-top:5px;">
			<div style="margin:0px;padding:0px;margin-bottom:20px;word-break:break-word;"><p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">本文将给出25个iptables常用规则示例，这些例子为您提供了些基本的模板，您可以根据特定需求对其进行修改调整以达到期望。<span style="margin:0px;padding:0px;line-height:1.5;">  格式</span></p>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">iptables [-t 表名] 选项 [链名] [条件] [-j 控制类型] 参数</p>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">P <span style="margin:0px;padding:0px;line-height:1.5;">设置默认策略:<span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">P INPUT <span style="margin:0px;padding:0px;line-height:1.5;">(<span style="margin:0px;padding:0px;line-height:1.5;">DROP<span style="margin:0px;padding:0px;line-height:1.5;">|<span style="margin:0px;padding:0px;line-height:1.5;">ACCEPT<span style="margin:0px;padding:0px;line-height:1.5;">)</span></span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">F <span style="margin:0px;padding:0px;line-height:1.5;">清空规则链</span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">L <span style="margin:0px;padding:0px;line-height:1.5;">查看规则链</span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A <span style="margin:0px;padding:0px;line-height:1.5;">在规则链的末尾加入新规则</span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">I num <span style="margin:0px;padding:0px;line-height:1.5;">在规则链的头部加入新规则</span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">D num <span style="margin:0px;padding:0px;line-height:1.5;">删除某一条规则</span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">s <span style="margin:0px;padding:0px;line-height:1.5;">匹配来源地址<span style="margin:0px;padding:0px;line-height:1.5;">IP<span style="margin:0px;padding:0px;line-height:1.5;">/<span style="margin:0px;padding:0px;line-height:1.5;">MASK<span style="margin:0px;padding:0px;line-height:1.5;">，加叹号<span style="margin:0px;padding:0px;line-height:1.5;">&quot;!&quot;<span style="margin:0px;padding:0px;line-height:1.5;">表示除这个<span style="margin:0px;padding:0px;line-height:1.5;">IP<span style="margin:0px;padding:0px;line-height:1.5;">外。</span></span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">d <span style="margin:0px;padding:0px;line-height:1.5;">匹配目标地址</span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">i <span style="margin:0px;padding:0px;line-height:1.5;">网卡名称<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">匹配从这块网卡流入的数据</span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">o <span style="margin:0px;padding:0px;line-height:1.5;">网卡名称<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">匹配从这块网卡流出的数据</span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p <span style="margin:0px;padding:0px;line-height:1.5;">匹配协议,如<span style="margin:0px;padding:0px;line-height:1.5;">tcp<span style="margin:0px;padding:0px;line-height:1.5;">,<span style="margin:0px;padding:0px;line-height:1.5;">udp<span style="margin:0px;padding:0px;line-height:1.5;">,<span style="margin:0px;padding:0px;line-height:1.5;">icmp</span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">dport num <span style="margin:0px;padding:0px;line-height:1.5;">匹配目标端口号</span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">sport num <span style="margin:0px;padding:0px;line-height:1.5;">匹配来源端口号</span></span></span></code></li>
</ol>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">示例</p>
<blockquote style="border-color:#d6dbdf;background:0px 0px rgba(102, 128, 153, 0.047058);padding:10px 15px;margin-top:10px;margin-bottom:10px;margin:0px 0px 20px;line-height:1.6em;color:#2c3e50;margin-left:0px;border:2px solid rgb(239, 239, 239);font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;text-transform:none;text-indent:0px;letter-spacing:normal;word-spacing:0px;border-left-width:10px;border-left-style:solid;white-space:normal;widows:1;">
<h1 style="padding:0px;font-size:28px;font-weight:bold;line-height:1.5;margin:10px 0px;">1. 删除已有规则</h1>
</blockquote>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">在开始创建iptables规则之前，你也许需要删除已有规则。</p>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">命令如下：</span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">F</span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">(<span style="margin:0px;padding:0px;line-height:1.5;">or<span style="margin:0px;padding:0px;line-height:1.5;">)</span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">–<span style="margin:0px;padding:0px;line-height:1.5;">flush</span></span></span></code></li>
</ol>
<blockquote style="border-color:#d6dbdf;background:0px 0px rgba(102, 128, 153, 0.047058);padding:10px 15px;margin-top:10px;margin-bottom:10px;margin:0px 0px 20px;line-height:1.6em;color:#2c3e50;margin-left:0px;border:2px solid rgb(239, 239, 239);font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;text-transform:none;text-indent:0px;letter-spacing:normal;word-spacing:0px;border-left-width:10px;border-left-style:solid;white-space:normal;widows:1;">
<h1 style="padding:0px;font-size:28px;font-weight:bold;line-height:1.5;margin:10px 0px;">2.设置链的默认策略</h1>
</blockquote>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">链的默认政策设置为”ACCEPT”（接受），若要将INPUT,FORWARD,OUTPUT链设置成”DROP”（拒绝），命令如下：</p>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">P INPUT DROP</span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">P FORWARD DROP</span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">P OUTPUT DROP</span></span></span></code></li>
</ol>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">当INPUT链和OUTPUT链都设置成DROP时，对于每一个防火墙规则，我们都应该定义两个规则。例如：一个传入另一个传出。在下面所有的例子中，由于我们已将DROP设置成INPUT链和OUTPUT链的默认策略，每种情况我们都将制定两条规则。当然，如果你相信你的内部用户,则可以省略上面的最后一行。例如：默认不丢弃所有出站的数据包。在这种情况下,对于每一个防火墙规则要求,你只需要制定一个规则——只对进站的数据包制定规则。</p>
<blockquote style="border-color:#d6dbdf;background:0px 0px rgba(102, 128, 153, 0.047058);padding:10px 15px;margin-top:10px;margin-bottom:10px;margin:0px 0px 20px;line-height:1.6em;color:#2c3e50;margin-left:0px;border:2px solid rgb(239, 239, 239);font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;text-transform:none;text-indent:0px;letter-spacing:normal;word-spacing:0px;border-left-width:10px;border-left-style:solid;white-space:normal;widows:1;">
<h1 style="padding:0px;font-size:28px;font-weight:bold;line-height:1.5;margin:10px 0px;">3. 阻止指定IP地址</h1>
</blockquote>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">例：丢弃来自IP地址x.x.x.x的包</p>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A INPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">s x<span style="margin:0px;padding:0px;line-height:1.5;">.<span style="margin:0px;padding:0px;line-height:1.5;">x<span style="margin:0px;padding:0px;line-height:1.5;">.<span style="margin:0px;padding:0px;line-height:1.5;">x<span style="margin:0px;padding:0px;line-height:1.5;">.<span style="margin:0px;padding:0px;line-height:1.5;">x <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j DROP</span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">注：当你在<span style="margin:0px;padding:0px;line-height:1.5;">log<span style="margin:0px;padding:0px;line-height:1.5;">里发现来自某<span style="margin:0px;padding:0px;line-height:1.5;">ip<span style="margin:0px;padding:0px;line-height:1.5;">地址的异常记录，可以通过此命令暂时阻止该地址的访问以做更深入分析</span></span></span></span></span></code></li>
</ol>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">例：阻止来自IP地址x.x.x.x eth0 tcp的包</p>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A INPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">i eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">s x<span style="margin:0px;padding:0px;line-height:1.5;">.<span style="margin:0px;padding:0px;line-height:1.5;">x<span style="margin:0px;padding:0px;line-height:1.5;">.<span style="margin:0px;padding:0px;line-height:1.5;">x<span style="margin:0px;padding:0px;line-height:1.5;">.<span style="margin:0px;padding:0px;line-height:1.5;">x <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j DROP</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A INPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">i eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">s x<span style="margin:0px;padding:0px;line-height:1.5;">.<span style="margin:0px;padding:0px;line-height:1.5;">x<span style="margin:0px;padding:0px;line-height:1.5;">.<span style="margin:0px;padding:0px;line-height:1.5;">x<span style="margin:0px;padding:0px;line-height:1.5;">.<span style="margin:0px;padding:0px;line-height:1.5;">x <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j DROP</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
</ol>
<blockquote style="border-color:#d6dbdf;background:0px 0px rgba(102, 128, 153, 0.047058);padding:10px 15px;margin-top:10px;margin-bottom:10px;margin:0px 0px 20px;line-height:1.6em;color:#2c3e50;margin-left:0px;border:2px solid rgb(239, 239, 239);font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;text-transform:none;text-indent:0px;letter-spacing:normal;word-spacing:0px;border-left-width:10px;border-left-style:solid;white-space:normal;widows:1;">
<h1 style="padding:0px;font-size:28px;font-weight:bold;line-height:1.5;margin:10px 0px;">4. 允许所有SSH的连接请求</h1>
</blockquote>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">例：允许所有来自外部的SSH连接请求，即只允许进入eth0接口，并且目标端口为22的数据包</p>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A INPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">i eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">dport <span style="margin:0px;padding:0px;line-height:1.5;">22<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state NEW<span style="margin:0px;padding:0px;line-height:1.5;">,<span style="margin:0px;padding:0px;line-height:1.5;">ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A OUTPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">o eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">sport <span style="margin:0px;padding:0px;line-height:1.5;">22<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
</ol>
<blockquote style="border-color:#d6dbdf;background:0px 0px rgba(102, 128, 153, 0.047058);padding:10px 15px;margin-top:10px;margin-bottom:10px;margin:0px 0px 20px;line-height:1.6em;color:#2c3e50;margin-left:0px;border:2px solid rgb(239, 239, 239);font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;text-transform:none;text-indent:0px;letter-spacing:normal;word-spacing:0px;border-left-width:10px;border-left-style:solid;white-space:normal;widows:1;">
<h1 style="padding:0px;font-size:28px;font-weight:bold;line-height:1.5;margin:10px 0px;">5. 仅允许来自指定网络的SSH连接请求</h1>
</blockquote>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">例：仅允许来自于192.168.100.0/24域的用户的ssh连接请求</p>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A INPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">i eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">s <span style="margin:0px;padding:0px;line-height:1.5;">192.168<span style="margin:0px;padding:0px;line-height:1.5;">.<span style="margin:0px;padding:0px;line-height:1.5;">100.0<span style="margin:0px;padding:0px;line-height:1.5;">/<span style="margin:0px;padding:0px;line-height:1.5;">24<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">dport <span style="margin:0px;padding:0px;line-height:1.5;">22<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state NEW<span style="margin:0px;padding:0px;line-height:1.5;">,<span style="margin:0px;padding:0px;line-height:1.5;">ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A OUTPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">o eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">sport <span style="margin:0px;padding:0px;line-height:1.5;">22<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
</ol>
<blockquote style="border-color:#d6dbdf;background:0px 0px rgba(102, 128, 153, 0.047058);padding:10px 15px;margin-top:10px;margin-bottom:10px;margin:0px 0px 20px;line-height:1.6em;color:#2c3e50;margin-left:0px;border:2px solid rgb(239, 239, 239);font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;text-transform:none;text-indent:0px;letter-spacing:normal;word-spacing:0px;border-left-width:10px;border-left-style:solid;white-space:normal;widows:1;">
<h1 style="padding:0px;font-size:28px;font-weight:bold;line-height:1.5;margin:10px 0px;">6.允许http和https的连接请求</h1>
</blockquote>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">例：允许所有来自web - http的连接请求</p>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A INPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">i eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">dport <span style="margin:0px;padding:0px;line-height:1.5;">80<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state NEW<span style="margin:0px;padding:0px;line-height:1.5;">,<span style="margin:0px;padding:0px;line-height:1.5;">ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A OUTPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">o eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">sport <span style="margin:0px;padding:0px;line-height:1.5;">80<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
</ol>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">例：允许所有来自web - https的连接请求</p>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A INPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">i eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">dport <span style="margin:0px;padding:0px;line-height:1.5;">443<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state NEW<span style="margin:0px;padding:0px;line-height:1.5;">,<span style="margin:0px;padding:0px;line-height:1.5;">ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A OUTPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">o eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">sport <span style="margin:0px;padding:0px;line-height:1.5;">443<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
</ol>
<blockquote style="border-color:#d6dbdf;background:0px 0px rgba(102, 128, 153, 0.047058);padding:10px 15px;margin-top:10px;margin-bottom:10px;margin:0px 0px 20px;line-height:1.6em;color:#2c3e50;margin-left:0px;border:2px solid rgb(239, 239, 239);font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;text-transform:none;text-indent:0px;letter-spacing:normal;word-spacing:0px;border-left-width:10px;border-left-style:solid;white-space:normal;widows:1;">
<h1 style="padding:0px;font-size:28px;font-weight:bold;line-height:1.5;margin:10px 0px;">7. 使用multiport 将多个规则结合在一起</h1>
</blockquote>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">允许多个端口从外界连入，除了为每个端口都写一条独立的规则外，我们可以用multiport将其组合成一条规则。如下所示：<span style="margin:0px;padding:0px;line-height:1.5;">  例：允许所有ssh,http,https的流量访问</span></p>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A INPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">i eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m multiport <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">dports <span style="margin:0px;padding:0px;line-height:1.5;">22<span style="margin:0px;padding:0px;line-height:1.5;">,<span style="margin:0px;padding:0px;line-height:1.5;">80<span style="margin:0px;padding:0px;line-height:1.5;">,<span style="margin:0px;padding:0px;line-height:1.5;">443<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state NEW<span style="margin:0px;padding:0px;line-height:1.5;">,<span style="margin:0px;padding:0px;line-height:1.5;">ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A OUTPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">o eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m multiport <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">sports <span style="margin:0px;padding:0px;line-height:1.5;">22<span style="margin:0px;padding:0px;line-height:1.5;">,<span style="margin:0px;padding:0px;line-height:1.5;">80<span style="margin:0px;padding:0px;line-height:1.5;">,<span style="margin:0px;padding:0px;line-height:1.5;">443<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
</ol>
<blockquote style="border-color:#d6dbdf;background:0px 0px rgba(102, 128, 153, 0.047058);padding:10px 15px;margin-top:10px;margin-bottom:10px;margin:0px 0px 20px;line-height:1.6em;color:#2c3e50;margin-left:0px;border:2px solid rgb(239, 239, 239);font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;text-transform:none;text-indent:0px;letter-spacing:normal;word-spacing:0px;border-left-width:10px;border-left-style:solid;white-space:normal;widows:1;">
<h1 style="padding:0px;font-size:28px;font-weight:bold;line-height:1.5;margin:10px 0px;">8. 允许从本地发起的SSH</h1>
</blockquote>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A OUTPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">o eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">dport <span style="margin:0px;padding:0px;line-height:1.5;">22<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state NEW<span style="margin:0px;padding:0px;line-height:1.5;">,<span style="margin:0px;padding:0px;line-height:1.5;">ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A INPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">i eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">sport <span style="margin:0px;padding:0px;line-height:1.5;">22<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
</ol>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">请注意,这与允许ssh连入的规则略有不同。本例在OUTPUT链上，我们允许NEW和ESTABLISHED状态。在INPUT链上，我们只允许ESTABLISHED状态。ssh连入的规则与之相反。</p>
<blockquote style="border-color:#d6dbdf;background:0px 0px rgba(102, 128, 153, 0.047058);padding:10px 15px;margin-top:10px;margin-bottom:10px;margin:0px 0px 20px;line-height:1.6em;color:#2c3e50;margin-left:0px;border:2px solid rgb(239, 239, 239);font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;text-transform:none;text-indent:0px;letter-spacing:normal;word-spacing:0px;border-left-width:10px;border-left-style:solid;white-space:normal;widows:1;">
<h1 style="padding:0px;font-size:28px;font-weight:bold;line-height:1.5;margin:10px 0px;">9. 仅允许从本地发起到一个指定的网络域的SSH请求</h1>
</blockquote>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">例：仅允许从内部连接到网域192.168.100.0/24</p>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A OUTPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">o eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">d <span style="margin:0px;padding:0px;line-height:1.5;">192.168<span style="margin:0px;padding:0px;line-height:1.5;">.<span style="margin:0px;padding:0px;line-height:1.5;">100.0<span style="margin:0px;padding:0px;line-height:1.5;">/<span style="margin:0px;padding:0px;line-height:1.5;">24<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">dport <span style="margin:0px;padding:0px;line-height:1.5;">22<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state NEW<span style="margin:0px;padding:0px;line-height:1.5;">,<span style="margin:0px;padding:0px;line-height:1.5;">ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A INPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">i eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">sport <span style="margin:0px;padding:0px;line-height:1.5;">22<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
</ol>
<blockquote style="border-color:#d6dbdf;background:0px 0px rgba(102, 128, 153, 0.047058);padding:10px 15px;margin-top:10px;margin-bottom:10px;margin:0px 0px 20px;line-height:1.6em;color:#2c3e50;margin-left:0px;border:2px solid rgb(239, 239, 239);font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;text-transform:none;text-indent:0px;letter-spacing:normal;word-spacing:0px;border-left-width:10px;border-left-style:solid;white-space:normal;widows:1;">
<h1 style="padding:0px;font-size:28px;font-weight:bold;line-height:1.5;margin:10px 0px;">10. 允许从本地发起的HTTPS连接请求</h1>
</blockquote>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">下面的规则允许输出安全的网络流量。如果你想允许用户访问互联网，这是非常有必要的。在服务器上，这些规则能让你使用wget从外部下载一些文件</p>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A OUTPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">o eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">dport <span style="margin:0px;padding:0px;line-height:1.5;">443<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state NEW<span style="margin:0px;padding:0px;line-height:1.5;">,<span style="margin:0px;padding:0px;line-height:1.5;">ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A INPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">i eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">sport <span style="margin:0px;padding:0px;line-height:1.5;">443<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
</ol>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">注：对于HTTP web流量的外联请求，只需要将上述命令中的端口从443改成80即可。</p>
<blockquote style="border-color:#d6dbdf;background:0px 0px rgba(102, 128, 153, 0.047058);padding:10px 15px;margin-top:10px;margin-bottom:10px;margin:0px 0px 20px;line-height:1.6em;color:#2c3e50;margin-left:0px;border:2px solid rgb(239, 239, 239);font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;text-transform:none;text-indent:0px;letter-spacing:normal;word-spacing:0px;border-left-width:10px;border-left-style:solid;white-space:normal;widows:1;">
<h1 style="padding:0px;font-size:28px;font-weight:bold;line-height:1.5;margin:10px 0px;">11. 负载平衡传入的网络流量</h1>
</blockquote>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">使用iptables可以实现传入web流量的负载均衡，我们可以传入web流量负载平衡使用iptables防火墙规则。<span style="margin:0px;padding:0px;line-height:1.5;">  例：使用iptables nth将HTTPS流量负载平衡至三个不同的ip地址。</span></p>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A PREROUTING <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">i eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">dport <span style="margin:0px;padding:0px;line-height:1.5;">443<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state NEW <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m nth <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">counter <span style="margin:0px;padding:0px;line-height:1.5;">0<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">every <span style="margin:0px;padding:0px;line-height:1.5;">3<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">packet <span style="margin:0px;padding:0px;line-height:1.5;">0<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j DNAT <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">to<span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">destination <span style="margin:0px;padding:0px;line-height:1.5;">192.168<span style="margin:0px;padding:0px;line-height:1.5;">.<span style="margin:0px;padding:0px;line-height:1.5;">1.101<span style="margin:0px;padding:0px;line-height:1.5;">:<span style="margin:0px;padding:0px;line-height:1.5;">443</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A PREROUTING <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">i eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">dport <span style="margin:0px;padding:0px;line-height:1.5;">443<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state NEW <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m nth <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">counter <span style="margin:0px;padding:0px;line-height:1.5;">0<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">every <span style="margin:0px;padding:0px;line-height:1.5;">3<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">packet <span style="margin:0px;padding:0px;line-height:1.5;">1<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j DNAT <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">to<span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">destination <span style="margin:0px;padding:0px;line-height:1.5;">192.168<span style="margin:0px;padding:0px;line-height:1.5;">.<span style="margin:0px;padding:0px;line-height:1.5;">1.102<span style="margin:0px;padding:0px;line-height:1.5;">:<span style="margin:0px;padding:0px;line-height:1.5;">443</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A PREROUTING <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">i eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">dport <span style="margin:0px;padding:0px;line-height:1.5;">443<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state NEW <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m nth <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">counter <span style="margin:0px;padding:0px;line-height:1.5;">0<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">every <span style="margin:0px;padding:0px;line-height:1.5;">3<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">packet <span style="margin:0px;padding:0px;line-height:1.5;">2<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j DNAT <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">to<span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">destination <span style="margin:0px;padding:0px;line-height:1.5;">192.168<span style="margin:0px;padding:0px;line-height:1.5;">.<span style="margin:0px;padding:0px;line-height:1.5;">1.103<span style="margin:0px;padding:0px;line-height:1.5;">:<span style="margin:0px;padding:0px;line-height:1.5;">443</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
</ol>
<blockquote style="border-color:#d6dbdf;background:0px 0px rgba(102, 128, 153, 0.047058);padding:10px 15px;margin-top:10px;margin-bottom:10px;margin:0px 0px 20px;line-height:1.6em;color:#2c3e50;margin-left:0px;border:2px solid rgb(239, 239, 239);font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;text-transform:none;text-indent:0px;letter-spacing:normal;word-spacing:0px;border-left-width:10px;border-left-style:solid;white-space:normal;widows:1;">
<h1 style="padding:0px;font-size:28px;font-weight:bold;line-height:1.5;margin:10px 0px;">12. 允许外部主机ping内部主机</h1>
</blockquote>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A INPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p icmp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">icmp<span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">type echo<span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">request <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A OUTPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p icmp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">icmp<span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">type echo<span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">reply <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
</ol>
<blockquote style="border-color:#d6dbdf;background:0px 0px rgba(102, 128, 153, 0.047058);padding:10px 15px;margin-top:10px;margin-bottom:10px;margin:0px 0px 20px;line-height:1.6em;color:#2c3e50;margin-left:0px;border:2px solid rgb(239, 239, 239);font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;text-transform:none;text-indent:0px;letter-spacing:normal;word-spacing:0px;border-left-width:10px;border-left-style:solid;white-space:normal;widows:1;">
<h1 style="padding:0px;font-size:28px;font-weight:bold;line-height:1.5;margin:10px 0px;">13. 允许内部主机ping外部主机</h1>
</blockquote>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A OUTPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p icmp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">icmp<span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">type echo<span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">request <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A INPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p icmp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">icmp<span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">type echo<span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">reply <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
</ol>
<blockquote style="border-color:#d6dbdf;background:0px 0px rgba(102, 128, 153, 0.047058);padding:10px 15px;margin-top:10px;margin-bottom:10px;margin:0px 0px 20px;line-height:1.6em;color:#2c3e50;margin-left:0px;border:2px solid rgb(239, 239, 239);font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;text-transform:none;text-indent:0px;letter-spacing:normal;word-spacing:0px;border-left-width:10px;border-left-style:solid;white-space:normal;widows:1;">
<h1 style="padding:0px;font-size:28px;font-weight:bold;line-height:1.5;margin:10px 0px;">14. 允许回环访问</h1>
</blockquote>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">例：在服务器上允许127.0.0.1回环访问。</p>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A INPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">i lo <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A OUTPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">o lo <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></code></li>
</ol>
<blockquote style="border-color:#d6dbdf;background:0px 0px rgba(102, 128, 153, 0.047058);padding:10px 15px;margin-top:10px;margin-bottom:10px;margin:0px 0px 20px;line-height:1.6em;color:#2c3e50;margin-left:0px;border:2px solid rgb(239, 239, 239);font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;text-transform:none;text-indent:0px;letter-spacing:normal;word-spacing:0px;border-left-width:10px;border-left-style:solid;white-space:normal;widows:1;">
<h1 style="padding:0px;font-size:28px;font-weight:bold;line-height:1.5;margin:10px 0px;">15. 允许内部网络域外部网络的通信</h1>
</blockquote>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">防火墙服务器上的其中一个网卡连接到外部，另一个网卡连接到内部服务器，使用以下规则允许内部网络与外部网络的通信。此例中，eth1连接到外部网络(互联网)，eth0连接到内部网络(例如:192.168.1.x)。</p>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A FORWARD <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">i eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">o eth1 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></code></li>
</ol>
<blockquote style="border-color:#d6dbdf;background:0px 0px rgba(102, 128, 153, 0.047058);padding:10px 15px;margin-top:10px;margin-bottom:10px;margin:0px 0px 20px;line-height:1.6em;color:#2c3e50;margin-left:0px;border:2px solid rgb(239, 239, 239);font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;text-transform:none;text-indent:0px;letter-spacing:normal;word-spacing:0px;border-left-width:10px;border-left-style:solid;white-space:normal;widows:1;">
<h1 style="padding:0px;font-size:28px;font-weight:bold;line-height:1.5;margin:10px 0px;">16. 允许出站的DNS连接</h1>
</blockquote>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A OUTPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p udp <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">o eth0 <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">dport <span style="margin:0px;padding:0px;line-height:1.5;">53<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A INPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p udp <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">i eth0 <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">sport <span style="margin:0px;padding:0px;line-height:1.5;">53<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
</ol>
<blockquote style="border-color:#d6dbdf;background:0px 0px rgba(102, 128, 153, 0.047058);padding:10px 15px;margin-top:10px;margin-bottom:10px;margin:0px 0px 20px;line-height:1.6em;color:#2c3e50;margin-left:0px;border:2px solid rgb(239, 239, 239);font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;text-transform:none;text-indent:0px;letter-spacing:normal;word-spacing:0px;border-left-width:10px;border-left-style:solid;white-space:normal;widows:1;">
<h1 style="padding:0px;font-size:28px;font-weight:bold;line-height:1.5;margin:10px 0px;">17. 允许NIS连接</h1>
</blockquote>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">如果你使用NIS管理用户帐户，你需要允许NIS连接。如果你不允许NIS相关的ypbind连接请求，即使SSH连接请求已被允许，用户仍然无法登录。NIS的端口是动态的，先使用命令rpcinfo –p来知道端口号，此例中为853和850端口。<span style="margin:0px;padding:0px;line-height:1.5;">  rpcinfo -p | grep ypbind<span style="margin:0px;padding:0px;line-height:1.5;">  例：允许来自111端口以及ypbind使用端口的连接请求</span></span></p>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A INPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">dport <span style="margin:0px;padding:0px;line-height:1.5;">111<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A INPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p udp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">dport <span style="margin:0px;padding:0px;line-height:1.5;">111<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A INPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">dport <span style="margin:0px;padding:0px;line-height:1.5;">853<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A INPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p udp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">dport <span style="margin:0px;padding:0px;line-height:1.5;">853<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A INPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">dport <span style="margin:0px;padding:0px;line-height:1.5;">850<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A INPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p udp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">dport <span style="margin:0px;padding:0px;line-height:1.5;">850<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></code></li>
</ol>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">注：当你重启ypbind之后端口将不同，上述命令将无效。有两种解决方案：1）使用你NIS的静态IP 2）编写shell脚本通过“rpcinfo - p”命令自动获取动态端口号,并在上述iptables规则中使用。</p>
<blockquote style="border-color:#d6dbdf;background:0px 0px rgba(102, 128, 153, 0.047058);padding:10px 15px;margin-top:10px;margin-bottom:10px;margin:0px 0px 20px;line-height:1.6em;color:#2c3e50;margin-left:0px;border:2px solid rgb(239, 239, 239);font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;text-transform:none;text-indent:0px;letter-spacing:normal;word-spacing:0px;border-left-width:10px;border-left-style:solid;white-space:normal;widows:1;">
<h1 style="padding:0px;font-size:28px;font-weight:bold;line-height:1.5;margin:10px 0px;">18. 允许来自指定网络的rsync连接请求</h1>
</blockquote>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">例：允许来自网络192.168.101.0/24的rsync连接请求</p>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A INPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">i eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">s <span style="margin:0px;padding:0px;line-height:1.5;">192.168<span style="margin:0px;padding:0px;line-height:1.5;">.<span style="margin:0px;padding:0px;line-height:1.5;">101.0<span style="margin:0px;padding:0px;line-height:1.5;">/<span style="margin:0px;padding:0px;line-height:1.5;">24<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">dport <span style="margin:0px;padding:0px;line-height:1.5;">873<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state NEW<span style="margin:0px;padding:0px;line-height:1.5;">,<span style="margin:0px;padding:0px;line-height:1.5;">ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A OUTPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">o eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">sport <span style="margin:0px;padding:0px;line-height:1.5;">873<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
</ol>
<blockquote style="border-color:#d6dbdf;background:0px 0px rgba(102, 128, 153, 0.047058);padding:10px 15px;margin-top:10px;margin-bottom:10px;margin:0px 0px 20px;line-height:1.6em;color:#2c3e50;margin-left:0px;border:2px solid rgb(239, 239, 239);font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;text-transform:none;text-indent:0px;letter-spacing:normal;word-spacing:0px;border-left-width:10px;border-left-style:solid;white-space:normal;widows:1;">
<h1 style="padding:0px;font-size:28px;font-weight:bold;line-height:1.5;margin:10px 0px;">19. 允许来自指定网络的MySQL连接请求</h1>
</blockquote>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">很多情况下，MySQL数据库与web服务跑在同一台服务器上。有时候我们仅希望DBA和开发人员从内部网络（192.168.100.0/24）直接登录数据库，可尝试以下命令：</p>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A INPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">i eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">s <span style="margin:0px;padding:0px;line-height:1.5;">192.168<span style="margin:0px;padding:0px;line-height:1.5;">.<span style="margin:0px;padding:0px;line-height:1.5;">100.0<span style="margin:0px;padding:0px;line-height:1.5;">/<span style="margin:0px;padding:0px;line-height:1.5;">24<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">dport <span style="margin:0px;padding:0px;line-height:1.5;">3306<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state NEW<span style="margin:0px;padding:0px;line-height:1.5;">,<span style="margin:0px;padding:0px;line-height:1.5;">ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A OUTPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">o eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">sport <span style="margin:0px;padding:0px;line-height:1.5;">3306<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
</ol>
<blockquote style="border-color:#d6dbdf;background:0px 0px rgba(102, 128, 153, 0.047058);padding:10px 15px;margin-top:10px;margin-bottom:10px;margin:0px 0px 20px;line-height:1.6em;color:#2c3e50;margin-left:0px;border:2px solid rgb(239, 239, 239);font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;text-transform:none;text-indent:0px;letter-spacing:normal;word-spacing:0px;border-left-width:10px;border-left-style:solid;white-space:normal;widows:1;">
<h1 style="padding:0px;font-size:28px;font-weight:bold;line-height:1.5;margin:10px 0px;">20. 允许Sendmail, Postfix邮件服务</h1>
</blockquote>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">Sendmail和postfix都使用了25端口，因此我们只需要允许来自25端口的连接请求即可。</p>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A INPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">i eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">dport <span style="margin:0px;padding:0px;line-height:1.5;">25<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state NEW<span style="margin:0px;padding:0px;line-height:1.5;">,<span style="margin:0px;padding:0px;line-height:1.5;">ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A OUTPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">o eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">sport <span style="margin:0px;padding:0px;line-height:1.5;">25<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
</ol>
<blockquote style="border-color:#d6dbdf;background:0px 0px rgba(102, 128, 153, 0.047058);padding:10px 15px;margin-top:10px;margin-bottom:10px;margin:0px 0px 20px;line-height:1.6em;color:#2c3e50;margin-left:0px;border:2px solid rgb(239, 239, 239);font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;text-transform:none;text-indent:0px;letter-spacing:normal;word-spacing:0px;border-left-width:10px;border-left-style:solid;white-space:normal;widows:1;">
<h1 style="padding:0px;font-size:28px;font-weight:bold;line-height:1.5;margin:10px 0px;">21. 允许IMAP和IMAPS</h1>
</blockquote>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">例：允许IMAP/IMAP2流量，端口为143</p>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A INPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">i eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">dport <span style="margin:0px;padding:0px;line-height:1.5;">143<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state NEW<span style="margin:0px;padding:0px;line-height:1.5;">,<span style="margin:0px;padding:0px;line-height:1.5;">ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A OUTPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">o eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">sport <span style="margin:0px;padding:0px;line-height:1.5;">143<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
</ol>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">例：允许IMAPS流量，端口为993</p>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A INPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">i eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">dport <span style="margin:0px;padding:0px;line-height:1.5;">993<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state NEW<span style="margin:0px;padding:0px;line-height:1.5;">,<span style="margin:0px;padding:0px;line-height:1.5;">ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A OUTPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">o eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">sport <span style="margin:0px;padding:0px;line-height:1.5;">993<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
</ol>
<blockquote style="border-color:#d6dbdf;background:0px 0px rgba(102, 128, 153, 0.047058);padding:10px 15px;margin-top:10px;margin-bottom:10px;margin:0px 0px 20px;line-height:1.6em;color:#2c3e50;margin-left:0px;border:2px solid rgb(239, 239, 239);font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;text-transform:none;text-indent:0px;letter-spacing:normal;word-spacing:0px;border-left-width:10px;border-left-style:solid;white-space:normal;widows:1;">
<h1 style="padding:0px;font-size:28px;font-weight:bold;line-height:1.5;margin:10px 0px;">22. 允许POP3和POP3S</h1>
</blockquote>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">例：允许POP3访问</p>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A INPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">i eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">dport <span style="margin:0px;padding:0px;line-height:1.5;">110<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state NEW<span style="margin:0px;padding:0px;line-height:1.5;">,<span style="margin:0px;padding:0px;line-height:1.5;">ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A OUTPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">o eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">sport <span style="margin:0px;padding:0px;line-height:1.5;">110<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
</ol>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">例：允许POP3S访问</p>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A INPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">i eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">dport <span style="margin:0px;padding:0px;line-height:1.5;">995<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state NEW<span style="margin:0px;padding:0px;line-height:1.5;">,<span style="margin:0px;padding:0px;line-height:1.5;">ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A OUTPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">o eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">sport <span style="margin:0px;padding:0px;line-height:1.5;">995<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
</ol>
<blockquote style="border-color:#d6dbdf;background:0px 0px rgba(102, 128, 153, 0.047058);padding:10px 15px;margin-top:10px;margin-bottom:10px;margin:0px 0px 20px;line-height:1.6em;color:#2c3e50;margin-left:0px;border:2px solid rgb(239, 239, 239);font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;text-transform:none;text-indent:0px;letter-spacing:normal;word-spacing:0px;border-left-width:10px;border-left-style:solid;white-space:normal;widows:1;">
<h1 style="padding:0px;font-size:28px;font-weight:bold;line-height:1.5;margin:10px 0px;">23. 防止DoS攻击</h1>
</blockquote>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A INPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">dport <span style="margin:0px;padding:0px;line-height:1.5;">80<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m limit <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">limit <span style="margin:0px;padding:0px;line-height:1.5;">25<span style="margin:0px;padding:0px;line-height:1.5;">/<span style="margin:0px;padding:0px;line-height:1.5;">minute <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">limit<span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">burst <span style="margin:0px;padding:0px;line-height:1.5;">100<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">上述例子中：</span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m limit<span style="margin:0px;padding:0px;line-height:1.5;">:<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">启用<span style="margin:0px;padding:0px;line-height:1.5;">limit<span style="margin:0px;padding:0px;line-height:1.5;">扩展</span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">–<span style="margin:0px;padding:0px;line-height:1.5;">limit <span style="margin:0px;padding:0px;line-height:1.5;">25<span style="margin:0px;padding:0px;line-height:1.5;">/<span style="margin:0px;padding:0px;line-height:1.5;">minute<span style="margin:0px;padding:0px;line-height:1.5;">:<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">允许最多每分钟<span style="margin:0px;padding:0px;line-height:1.5;">25<span style="margin:0px;padding:0px;line-height:1.5;">个连接（根据需求更改）。</span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">–<span style="margin:0px;padding:0px;line-height:1.5;">limit<span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">burst <span style="margin:0px;padding:0px;line-height:1.5;">100<span style="margin:0px;padding:0px;line-height:1.5;">:<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">只有当连接达到<span style="margin:0px;padding:0px;line-height:1.5;">limit<span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">burst<span style="margin:0px;padding:0px;line-height:1.5;">水平(此例为<span style="margin:0px;padding:0px;line-height:1.5;">100<span style="margin:0px;padding:0px;line-height:1.5;">)时才启用上述<span style="margin:0px;padding:0px;line-height:1.5;">limit<span style="margin:0px;padding:0px;line-height:1.5;">/<span style="margin:0px;padding:0px;line-height:1.5;">minute<span style="margin:0px;padding:0px;line-height:1.5;">限制。</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
</ol>
<blockquote style="border-color:#d6dbdf;background:0px 0px rgba(102, 128, 153, 0.047058);padding:10px 15px;margin-top:10px;margin-bottom:10px;margin:0px 0px 20px;line-height:1.6em;color:#2c3e50;margin-left:0px;border:2px solid rgb(239, 239, 239);font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;text-transform:none;text-indent:0px;letter-spacing:normal;word-spacing:0px;border-left-width:10px;border-left-style:solid;white-space:normal;widows:1;">
<h1 style="padding:0px;font-size:28px;font-weight:bold;line-height:1.5;margin:10px 0px;">24. 端口转发</h1>
</blockquote>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">例：将来自422端口的流量全部转到22端口。<span style="margin:0px;padding:0px;line-height:1.5;">  这意味着我们既能通过422端口又能通过22端口进行ssh连接。启用DNAT转发。</span></p>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">t nat <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A PREROUTING <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">d <span style="margin:0px;padding:0px;line-height:1.5;">192.168<span style="margin:0px;padding:0px;line-height:1.5;">.<span style="margin:0px;padding:0px;line-height:1.5;">102.37<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">dport <span style="margin:0px;padding:0px;line-height:1.5;">422<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j DNAT <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">to <span style="margin:0px;padding:0px;line-height:1.5;">192.168<span style="margin:0px;padding:0px;line-height:1.5;">.<span style="margin:0px;padding:0px;line-height:1.5;">102.37<span style="margin:0px;padding:0px;line-height:1.5;">:<span style="margin:0px;padding:0px;line-height:1.5;">22</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
</ol>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">除此之外，还需要允许连接到422端口的请求</p>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A INPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">i eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">dport <span style="margin:0px;padding:0px;line-height:1.5;">422<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state NEW<span style="margin:0px;padding:0px;line-height:1.5;">,<span style="margin:0px;padding:0px;line-height:1.5;">ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A OUTPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">o eth0 <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">p tcp <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">sport <span style="margin:0px;padding:0px;line-height:1.5;">422<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m state <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">state ESTABLISHED <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j ACCEPT</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
</ol>
<blockquote style="border-color:#d6dbdf;background:0px 0px rgba(102, 128, 153, 0.047058);padding:10px 15px;margin-top:10px;margin-bottom:10px;margin:0px 0px 20px;line-height:1.6em;color:#2c3e50;margin-left:0px;border:2px solid rgb(239, 239, 239);font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;text-transform:none;text-indent:0px;letter-spacing:normal;word-spacing:0px;border-left-width:10px;border-left-style:solid;white-space:normal;widows:1;">
<h1 style="padding:0px;font-size:28px;font-weight:bold;line-height:1.5;margin:10px 0px;">25. 记录丢弃的数据表</h1>
</blockquote>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">第一步：新建名为LOGGING的链</p>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">N LOGGING</span></span></span></code></li>
</ol>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">第二步：将所有来自INPUT链中的数据包跳转到LOGGING链中</p>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A INPUT <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j LOGGING</span></span></span></span></span></code></li>
</ol>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">第三步：为这些包自定义个前缀，命名为”IPTables Packet Dropped”</p>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A LOGGING <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">m limit <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">limit <span style="margin:0px;padding:0px;line-height:1.5;">2<span style="margin:0px;padding:0px;line-height:1.5;">/<span style="margin:0px;padding:0px;line-height:1.5;">min <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j LOG <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">log<span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">prefix <span style="margin:0px;padding:0px;line-height:1.5;">&quot;IPTables Packet Dropped: &quot;<span style="margin:0px;padding:0px;line-height:1.5;"> <span style="margin:0px;padding:0px;line-height:1.5;">--<span style="margin:0px;padding:0px;line-height:1.5;">log<span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">level <span style="margin:0px;padding:0px;line-height:1.5;">7</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></li>
</ol>
<p style="font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;margin:0px 0px 20px;padding:0px;line-height:1.5;color:#2c3e50;font-size:13px;text-indent:0px;text-transform:none;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;">第四步：丢弃这些数据包</p>
<div style="text-indent:0px;margin:0px;font:16px/27px &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft Yahei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:#2c3e50;text-transform:none;padding:0px;letter-spacing:normal;word-spacing:0px;white-space:normal;widows:1;background-color:#f9f9f5;"> </div>
<ol style="margin:0px;padding:0px;padding-left:40px;">
<li style="margin:0px;padding:0px;list-style:none;margin-bottom:1em;list-style-type:decimal;"><code style="margin:0px;padding:0px;border:0px currentColor;color:inherit;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:14px;white-space:pre-wrap;background-color:transparent;"><span style="margin:0px;padding:0px;line-height:1.5;">iptables <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">A LOGGING <span style="margin:0px;padding:0px;line-height:1.5;">-<span style="margin:0px;padding:0px;line-height:1.5;">j DROP</span></span></span></span></span></code></li>
</ol></div>
<div style="margin:0px;padding:0px;clear:both;"></div>
<div style="margin:0px;padding:0px;margin-top:20px;">
<div style="margin:0px;padding:0px;margin-bottom:10px;">分类: <a href="http://www.cnblogs.com/bill1015/category/1001305.html" style="margin:0px;padding:0px;text-decoration:underline;color:rgb(7, 93, 179);" target="_blank">Linux</a></div>
<div style="margin:0px;padding:0px;font-size:9pt;color:rgb(102, 102, 102);margin-top:0px;">标签: <a href="http://www.cnblogs.com/bill1015/tag/Linux%20iptables/" style="margin:0px;padding:0px;text-decoration:underline;margin-left:5px;color:rgb(102, 102, 102);">Linux iptables</a></div>
<div style="margin:0px;padding:0px;">
</div>
<div style="margin:0px;padding:0px;clear:both;"></div>
<div style="margin:0px;padding:0px;line-height:1.8;font-size:12px;"><a href="http://www.cnblogs.com/bill1015/p/6847842.html" style="margin:0px;padding:0px;color:rgb(7, 93, 179);text-decoration:none;">» </a> 下一篇：<a href="http://www.cnblogs.com/bill1015/p/6847842.html" style="margin:0px;padding:0px;text-decoration:underline;color:rgb(7, 93, 179);" title="发布于2017-05-13 01:05">saltstack安装+基本命令</a><br style="margin:0px;padding:0px;"/></div>
</div>


		</div>
		<div style="margin:0px;padding:0px;clear:both;font-size:12px;float:right;width:100%;text-align:right;padding-right:5px;color:rgb(102, 102, 102);margin-top:5px;">posted @ <span style="margin:0px;padding:0px;">2017-05-13 01:04</span> <a href="http://www.cnblogs.com/bill1015/" style="margin:0px;padding:0px;text-decoration:none;color:rgb(7, 93, 179);">追逐1015</a> 阅读(<span style="margin:0px;padding:0px;">9532</span>) 评论(<span style="margin:0px;padding:0px;">0</span>)  <a href="https://i.cnblogs.com/EditPosts.aspx?postid=6847841" rel="nofollow" style="margin:0px;padding:0px;text-decoration:none;color:rgb(7, 93, 179);">编辑</a> <a href="https://www.cnblogs.com/bill1015/p/6847841.html#" style="margin:0px;padding:0px;text-decoration:none;color:rgb(7, 93, 179);">收藏</a></div>
	</div></div></div></div></div></div></div></div></div></div>
</div>
</span>
</div></body></html> 